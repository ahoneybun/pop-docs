#!/usr/bin/make -f

include /usr/share/cdbs/1/rules/debhelper.mk
include /usr/share/cdbs/1/class/makefile.mk

DEB_DH_INSTALL_ARGS = -X.svn

DEB_SRCDIR = ubuntu

DEB_MAKE_BUILD_TARGET = gdeb

$(patsubst %,binary-install/%,$(DEB_PACKAGES)) :: binary-install/%:
	dh_scrollkeeper -p$(cdbs_curpkg) $(DEB_DH_SCROLLKEEPER_ARGS)

install755=install -m755 -oroot -groot
preptrans=prepare-firefox-startpage-translations
preptransdir=debian/ubuntu-docs/usr/share/ubuntu-docs/common

common-binary-post-install-indep::
	mv debian/ubuntu-docs/usr/share/ubuntu-artwork/home/index.html debian/ubuntu-docs/usr/share/ubuntu-artwork/home/firefox-index.html
	$(install755) -d $(preptransdir)
	$(install755) debian/$(preptrans) $(preptransdir)
	$(preptransdir)/$(preptrans) \
		ubuntu/browser-startpage \
		debian/ubuntu-docs \
		/usr/share/ubuntu-artwork/home/locales-ubuntu \
		../index.html

# Omf files

		for doc in about-ubuntu add-applications advanced-topics config-desktop internet keeping-safe musicvideophotos newtoubuntu printing; do \
			mkdir -p debian/ubuntu-docs/usr/share/omf/$$doc/; \
			cp ubuntu/$$doc/C/*omf debian/ubuntu-docs/usr/share/omf/$$doc/; \
		done; \

# Ubuntu documents

		for doc in about-ubuntu add-applications advanced-topics config-desktop games getting-help internet keeping-safe musicvideophotos newtoubuntu office printing programming switching; do \
			mkdir -p debian/ubuntu-docs/usr/share/gnome/help/$$doc/C/; \
			cp ubuntu/$$doc/C/*xml debian/ubuntu-docs/usr/share/gnome/help/$$doc/C/; \
		done; \

# Generic documents

		for doc in server contribute; do \
			mkdir -p debian/ubuntu-docs/usr/share/gnome/help/$$doc/C; \
			cp generic/$$doc/C/*xml debian/ubuntu-docs/usr/share/gnome/help/$$doc/C/; \
		done; \

# Common documents

	cp -r common debian/ubuntu-docs/usr/share/ubuntu-docs/ 

# Scrollkeeper loving

	dh_scrollkeeper 
