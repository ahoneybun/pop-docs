#!/usr/bin/make -f

include /usr/share/cdbs/1/rules/debhelper.mk
include /usr/share/cdbs/1/class/makefile.mk

DEB_DH_INSTALL_ARGS = -X.svn

DEB_SRCDIR = ubuntu

DEB_MAKE_BUILD_TARGET = gdeb

$(patsubst %,binary-install/%,$(DEB_PACKAGES)) :: binary-install/%:
	dh_scrollkeeper -p$(cdbs_curpkg) $(DEB_DH_SCROLLKEEPER_ARGS)

install755=install -m755 -oroot -groot
preptrans=prepare-firefox-startpage-translations
preptransdir=debian/ubuntu-docs/usr/share/ubuntu-docs/common

common-binary-post-install-indep::
	mv debian/ubuntu-docs/usr/share/ubuntu-artwork/home/index.html debian/ubuntu-docs/usr/share/ubuntu-artwork/home/firefox-index.html
	$(install755) -d $(preptransdir)
	$(install755) debian/$(preptrans) $(preptransdir)
	$(preptransdir)/$(preptrans) \
		ubuntu/browser-startpage \
		debian/ubuntu-docs \
		/usr/share/ubuntu-artwork/home/locales-ubuntu \
		../index.html

# Omf files

		for doc in about-ubuntu add-applications games getting-help internet musicvideophotos newtoubuntu office printing programming server contribute; do \
			mkdir -p debian/ubuntu-docs/usr/share/omf/$$doc/; \
			cp ubuntu/omf/$$doc* debian/ubuntu-docs/usr/share/omf/$$doc/; \
		done; \

# Ubuntu documents

		for doc in add-applications games getting-help internet musicvideophotos newtoubuntu office printing programming; do \
			mkdir -p debian/ubuntu-docs/usr/share/ubuntu-docs/xml/C/$$doc; \
			cp ubuntu/C/$$doc/*xml debian/ubuntu-docs/usr/share/ubuntu-docs/xml/C/$$doc/; \
		done; \

# Except about-ubuntu gets special treatment, needed for the menu entry to work

	mkdir -p debian/ubuntu-docs/usr/share/gnome/help/about-ubuntu/C
	cp ubuntu/C/about-ubuntu/about-ubuntu.xml debian/ubuntu-docs/usr/share/gnome/help/about-ubuntu/C/

# Generic documents

		for doc in serverguide contribute; do \
			mkdir -p debian/ubuntu-docs/usr/share/ubuntu-docs/xml/C/$$doc; \
			cp generic/$$doc/C/*xml debian/ubuntu-docs/usr/share/ubuntu-docs/xml/C/$$doc; \
		done; \

# Preface documents

	cp -r common debian/ubuntu-docs/usr/share/ubuntu-docs/ 

# Common documents

	mkdir -p debian/ubuntu-docs/usr/share/ubuntu-docs/ubuntu/menus/C
	cp ubuntu/menus/C/*.xml debian/ubuntu-docs/usr/share/ubuntu-docs/ubuntu/menus/C/

# Scrollkeeper loving

	dh_scrollkeeper 
