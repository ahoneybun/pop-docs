<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE chapter PUBLIC "-//OASIS//DTD DocBook XML V4.3//EN" 
	"http://www.oasis-open.org/docbook/xml/4.3/docbookx.dtd" [
<!ENTITY % globalent SYSTEM "../../../libs/global.ent">
%globalent;
<!ENTITY % genericent SYSTEM "../../libs/generic.ent">
%genericent;
<!ENTITY % cdo-C SYSTEM "../../../libs/cdo-C.ent">
%cdo-C;
<!ENTITY % gnome-menus-C SYSTEM "../../../ubuntu/libs/gnome-menus-C.ent">
%gnome-menus-C;
<!ENTITY % xinclude SYSTEM "../../../libs/xinclude.mod">
%xinclude;
<!ENTITY language "&EnglishAmerican;">
]>
	<chapter id="databases" status="complete">
		<title>Databases</title>
          <para>
            Ubuntu provides two Database servers. They are:
            <itemizedlist spacing="compact">
                <listitem>
                    <para><application><trademark>MySQL</trademark></application></para>
                </listitem>
                <listitem>
                    <para><application>PostgreSQL</application></para>
                </listitem>
            </itemizedlist>
            They are available in the main repository. This section
            explains how to install and configure these database
            servers.
          </para>
      <sect1 id="mysql" status="complete">
        <title>MySQL</title>
          <para>
          MySQL is a fast, multi-threaded, multi-user, and robust SQL
          database server. It is intended for mission-critical, 
		  heavy-load production systems as well as for embedding into 
		  mass-deployed software.
          </para>

        <sect2 id="mysql-installation" status="complete">
          <title>Installation</title>
            <para>
            To install MySQL, run the following command from a terminal prompt:
            </para>

            <para>
<screen>
<command>sudo apt-get install mysql-server mysql-client</command>
</screen>
            </para>

            <para>
            Once the installation is complete, the MySQL server should be
            started automatically. You can run the following command from a terminal prompt to
            check whether the MySQL server is running:
            </para>

            <para>
<screen>
<command>sudo netstat -tap | grep mysql</command>
</screen>
            </para>

            <para>
            When you run this command, you should see the following line
            or something similar:
            </para>

<programlisting>
tcp        0      0 localhost.localdomain:mysql           *:* LISTEN -
</programlisting>
	<para>If the server is not running correctly, you can type the following command to start it:</para>
            <para>
<screen>
<command>sudo /etc/init.d/mysql restart</command>
</screen>
        </para>

        </sect2>
        <sect2 id="mysql-configuration" status="complete">
          <title>Configuration</title>
            <para>
            By default, the administrator password is not set. Once you
            install MySQL, the first thing you must do is to configure
            the MySQL administrator password. To do this, run the following commands:
            </para>
            <para>
<screen>
<command>sudo mysqladmin -u root password newrootsqlpassword</command>
</screen>
            </para>
            <para>
<screen>
<command>sudo mysqladmin -p -u root -h localhost password newrootsqlpassword</command>
</screen>
            </para>

            <para>
            You can edit the <filename>/etc/mysql/my.cnf</filename> file to configure the basic
            settings -- log file, port number, etc. Refer to
            <filename>/etc/mysql/my.cnf</filename> file for more details.
            </para>
        </sect2>
      </sect1>
      <sect1 id="postgresql" status="complete">
        <title>PostgreSQL</title> 
          <para>
          PostgreSQL is an object-relational database system that has
          the features of traditional commercial database systems with
          enhancements to be found in next-generation DBMS systems.
          </para>
        <sect2 id="postgresql-installation" status="complete">
          <title>Installation</title>
            <para>
            To install PostgreSQL, run the following command in the
            command prompt:
            </para>

            <para>
<screen>
<command>sudo apt-get install postgresql</command>
</screen>
            </para>

            <para>
            Once the installation is complete, you should configure the
            PostgreSQL server based on your needs, although the default
            configuration is viable.</para>
            
        </sect2>
        <sect2 id="postgresql-configuration" status="complete">
          <title>Configuration</title>
            <para>By default, connection via TCP/IP is disabled.
            PostgreSQL supports multiple client authentication methods.
            By default, IDENT authentication method is used for <emphasis>postgres</emphasis> and local users
	 .  Please refer <ulink 
			url="http://www.postgresql.org/docs/8.2/static/admin.html">
			the PostgreSQL Administrator's Guide</ulink>.</para>
            
            <para>The following discussion assumes that you wish to enable 
			TCP/IP connections and use the MD5 method for client 
			authentication. PostgreSQL configuration files are stored in the
            <filename>/etc/postgresql/&lt;version&gt;/main</filename>
            directory. For example, if you install PostgreSQL 8.2, the
            configuration files are stored in the
            <filename>/etc/postgresql/8.2/main</filename> directory.
            </para>
            
            <tip>
            <para>
             To configure <application>ident</application>
             authentication, add entries to the <filename>/etc/postgresql/8.2/main/pg_ident.conf</filename>
             file.
            </para>
            </tip>

            <para>To enable TCP/IP connections, edit the file <filename>/etc/postgresql/8.2/main/postgresql.conf</filename></para>

            <para>Locate the line <emphasis>#listen_addresses = 'localhost'</emphasis> and change it to:
<programlisting>
listen_addresses = 'localhost'
</programlisting>
	    </para>
            <note>
	      <para>
	      To allow other computers to connect to your <application>PostgreSQL</application> server replace 'localhost' with 
	      the <emphasis>IP Address</emphasis> of your server.
              </para>
            </note>
	    <para> 
	    You may also edit all other parameters, if you know what you are doing! 
            For details, refer to the configuration file or to the PostgreSQL documentation.
            </para>

            <para>
	    Now that we can connect to our <application>PostgreSQL</application> server, the next step is to 
	    set a password for the <emphasis>postgres</emphasis> user.  Run the following command at a terminal 
	    prompt to connect to the default PostgreSQL template database:
	    </para>

            <para>
<screen>
<command>sudo -u postgres psql template1</command>
</screen>
            </para>
            <para>
            The above command connects to PostgreSQL database <emphasis>template1</emphasis> as user
            <emphasis>postgres</emphasis>. Once you connect to the PostgreSQL server, you will be 
	    at a SQL prompt. You can run the following SQL command at the <application>psql</application> 
	    prompt to configure the password for the user <emphasis role="italics">postgres</emphasis>.
	    </para>

            <para>
<screen>
<command>template1=# ALTER USER postgres with encrypted password 'your_password';</command>
</screen>
            </para>
            <para>
	    After configuring the password, edit the file
            <filename>/etc/postgresql/8.2/main/pg_hba.conf</filename> to use
            <emphasis>MD5</emphasis> authentication with the <emphasis>postgres</emphasis> user:
            </para>
<programlisting>
local   all         postgres                          md5 sameuser
</programlisting>

	    <para>
	    Finally, you should restart the <application>PostgreSQL</application> service to 
            initialize the new configuration.  From a terminal prompt enter the following to 
	    restart <application>PostgreSQL</application>:
            </para>
<screen>
<command>sudo /etc/init.d/postgresql-8.2 restart</command>
</screen>
            <warning>
            <para>
             The above configuration is not complete by any means. Please
             refer <ulink url="http://www.postgresql.org/docs/8.1/static/admin.html">
			 the PostgreSQL Administrator's Guide</ulink> to configure more parameters.
            </para>
            </warning>
        </sect2>
      </sect1>
    </chapter>

