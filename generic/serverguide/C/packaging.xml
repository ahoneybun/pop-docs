<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE chapter PUBLIC "-//OASIS//DTD DocBook XML V4.3//EN" 
	"http://www.oasis-open.org/docbook/xml/4.3/docbookx.dtd" [
<!ENTITY % globalent SYSTEM "../../../libs/global.ent">
%globalent;
<!ENTITY % cdo-C SYSTEM "../../../libs/cdo-C.ent">
%cdo-C;
<!ENTITY % gnome-menus-C SYSTEM "../../../ubuntu/libs/gnome-menus-C.ent">
%gnome-menus-C;
<!ENTITY % xinclude SYSTEM "../../../libs/xinclude.mod">
%xinclude;
<!ENTITY language "&EnglishAmerican;">
<!ENTITY ubuntu '<phrase>Ubuntu</phrase>'>
]>
<chapter id="packaging" status="review">
	<title>Package Management</title>
        <para>Ubuntu features a comprehensive package management system for the installation, upgrade, configuration, and removal of software.  In addition to providing access to an organized base of over seventeen-thousand (17,000) software packages for your Ubuntu computer, the package management facilities also feature dependency resolution capabilities, and software update checking.
        </para>
        <para>
        Several tools are available for interacting with Ubuntu's package management system, from simple command-line utilities which may be easily automated by System Administrators, to a simple, graphical interface which is easy to use by those new to Ubuntu.
        </para>
  <sect1 id="introduction-to-debian-packages" status="review">
	<title>Introduction to Debian Packages</title>
        <para>
        Ubuntu's package management system is derived from the same system used by the Debian GNU/Linux distribution.  The package files contain all of the necessary files, meta-data, and instructions to implement a particular functionality, or software application on your Ubuntu computer.
        </para>
        <para>
        Debian package files typically have the extension '.deb', and typically exist in <emphasis role="italics">repositories</emphasis> which are collections of packages found on various media, such as CD-ROM discs, or via HTTP for example.  Packages are normally of the pre-compiled binary format, thus installation is quick, and requires no compiling of software.
        </para>
        <para>
        Many complex packages use the concept of <emphasis role="italics">dependencies</emphasis>.  Dependencies are additional packages required by the principle package in order for the principle package to function properly.  For example, the speech synthesis package <emphasis role="italics">Festival</emphasis> depends upon the package <emphasis role="italics">festvox-kalpc16k</emphasis>, which is a package supplying one of the voices used by the festival application.  In order for the Festival application to function, all of the dependencies must be installed in conjunction with the principle Festival package.
        </para>
  </sect1>
  <sect1 id="aptitude" status="writing">
	<title>Aptitude</title>
        <para>
        Aptitude is a menu-driven, text-based front-end to the Advanced Package Tool (APT) system. Many of the common package management functions, such as installation, removal, and upgrade are performed in Aptitude with single-key commands, which are typically lowercase letters.
        </para>
        <para>
        Aptitude is best suited to use in a non-graphical terminal environment, to ensure proper functioning of the command keys.  You may start the Aptitude application as a normal user with the following command at a terminal prompt:
<screen>
<command>aptitude</command>
</screen>
        </para>
        <para>
        When Aptitude starts, you will see a menu bar at the top of the screen, and two panes below the menu bar.  The top pane contains package categories, such as <emphasis role="italics">New Packages</emphasis>,  and <emphasis role="italics">Not Installed Packages</emphasis>. The bottom pane contains information related to the packages, and package categories.
        </para>
        <para>Using Aptitude for package management is relatively straightforward, and the user interface makes common tasks simple to perform.  The following are examples of popular package management functions as performed in Aptitude:
        </para>
        <itemizedlist>
               <listitem>
                <para><emphasis role="bold">Install Packages</emphasis>: To install a package using Aptitude, locate the package via the Not Installed Packages package category, for example, by using the keyboard arrow keys, and the <keycap>ENTER</keycap> key, and highlight the package you wish to install.  After highlighting the package you wish to install, press the <keycap>+</keycap> key, and the package entry should turn <emphasis role="italics">green</emphasis>, indicating it has been marked for installation. Now press <keycap>g</keycap> whereby you'll be presented with a summary of package actions.  Press <keycap>g</keycap> again, and you will be prompted to become root to complete the installation. Press <keycap>ENTER</keycap> which will result in a Password: prompt.  Enter your user password to become root. Finally, press <keycap>g</keycap> once more, and you'll be prompted to download the package.  Press <keycap>ENTER</keycap> on the <emphasis role="italics">Continue</emphasis> prompt, and downloading, and installation of the package will commence.
                </para>
               </listitem>
               <listitem>
                <para><emphasis role="bold">Remove Packages</emphasis>: To remove a package using Aptitude, locate the package via the Installed Packages package category, for example, by using the keyboard arrow keys, and the <keycap>ENTER</keycap> key, and highlight the package you wish to remove.  After highlighting the package you wish to install, press the <keycap>-</keycap> key, and the package entry should turn <emphasis role="italics">pink</emphasis>, indicating it has been marked for removal. Now press <keycap>g</keycap> whereby you'll be presented with a summary of package actions.  Press <keycap>g</keycap> again, and you will be prompted to become root to complete the installation. Press <keycap>ENTER</keycap> which will result in a Password: prompt.  Enter your user password to become root. Finally, press <keycap>g</keycap> once more, and you'll be prompted to download the package.  Press <keycap>ENTER</keycap> on the <emphasis role="italics">Continue</emphasis> prompt, and removal of the package will commence.
                </para>
               </listitem>
               <listitem>
                <para><emphasis role="bold">Update Package Index</emphasis>: To update the package index, simply press the <keycap>u</keycap> key and you will be prompted to become root to complete the installation. Press <keycap>ENTER</keycap> which will result in a Password: prompt.  Enter your user password to become root. Updating of the package index will commence.  Press <keycap>ENTER</keycap> on the OK prompt when the download dialog is presented, to complete the process.
                </para>
               </listitem>
               <listitem>
                <para><emphasis role="bold">Upgrade Packages</emphasis>: To upgrade packages in Aptitude,  perform the update of the package index as detailed above, and then press the <keycap>U</keycap> key to mark all upgradeable packages. Now press <keycap>g</keycap> whereby you'll be presented with a summary of package actions.  Press <keycap>g</keycap> again, and you will be prompted to become root to complete the installation. Press <keycap>ENTER</keycap> which will result in a Password: prompt.  Enter your user password to become root. Finally, press <keycap>g</keycap> once more, and you'll be prompted to download the package.  Press <keycap>ENTER</keycap> on the <emphasis role="italics">Continue</emphasis> prompt, and upgrade of the packages will commence.
                </para>
               </listitem>
        </itemizedlist>
        <para>The first column of information displayed in the package list in the top pane, when actually viewing packages lists the current state of the package, and uses the following key to describe the state of the package:
        <itemizedlist>
        <listitem>
        <para>
        <emphasis role="bold">i</emphasis>: Installed package.
        </para>
        </listitem>
        <listitem>
        <para>
        <emphasis role="bold">c</emphasis>: Package not installed, but package configuration remains on system
        </para>
        </listitem><listitem>
        <para>
        <emphasis role="bold">p</emphasis>: Purged from system
        </para>
        </listitem><listitem>
        <para>
        <emphasis role="bold">v</emphasis>: Virtual package
        </para>
        </listitem><listitem>
        <para>
        <emphasis role="bold">B</emphasis>: Broken package
        </para>
        </listitem><listitem>
        <para>
        <emphasis role="bold">u</emphasis>: Unpacked files, but package not yet configured
        </para>
        </listitem><listitem>
        <para>
        <emphasis role="bold">C</emphasis>: Half-configured- Configuration failed, and requires fix
        </para>
        </listitem><listitem>
        <para>
        <emphasis role="bold">H</emphasis>: Half-installed- Removal failed, and requires fix
        </para>
        </listitem>
        </itemizedlist>
        </para>
        <para>To exit Aptitude, simply press the <keycap>q</keycap> key, and confirm you wish to exit. Many other functions are available from the Aptitude menu, by pressing the <keycap>F10</keycap> key.
        </para>
  </sect1>
  <sect1 id="apt-get" status="review">
	<title>apt-get</title>
        <para>
        The <application>apt-get</application> command is a powerful command-line tool used to work with Ubuntu's Advanced Package Tool (APT) performing such functions as installation of new software packages, upgrade of existing software packages, updating of the package list index, and even upgrading the entire Ubuntu system.
        </para>
        <para>
        Being a simple command-line tool, <application>apt-get</application> has numerous advantages over other package management tools available in Ubuntu for server administrators.  Some of these advantages include ease of use over simple terminal connections, (SSH) and the ability to be used in system administration scripts, which in turn, can be automated by the <application>cron</application> scheduling utility.
        </para>
        <para>
        Some examples of popular uses for the <application>apt-get</application> utility:
        <itemizedlist>
               <listitem>
                <para>
                <emphasis role="bold">Install Package</emphasis>: Installation of packages using the <application>apt-get</application> tool is quite simple.  For example, to install the network scanner <emphasis role="italics">nmap</emphasis>, type the following at a terminal prompt:
<screen>
<command>sudo apt-get install nmap</command>
</screen>
                </para>
                </listitem>
                <listitem>
                <para>
                <emphasis role="bold">Remove Package</emphasis>: Removal of a package, or packages is also a straightforward, and simple process. To remove the nmap package installed in the previous example, the following command typed at a terminal prompt would suffice:
<screen>
<command>sudo apt-get remove nmap</command>
</screen>
                </para>
                <tip>
                <para><emphasis role="bold">Multiple Packages</emphasis>: You may specify multiple packages to the install, and remove functions of <application>apt-get</application> on the same command line, separated by spaces.
                </para>
                </tip>
                </listitem>
                <listitem>
                <para>
                <emphasis role="bold">Update Package Index</emphasis>: The APT package index is essentially a database of available packages from the repositories defined in the <filename>/etc/apt/sources.list</filename> file.  To update the local package index with the latest changes made in repositories defined in your computer's repository listing, type the following at a terminal prompt:
<screen>
<command>sudo apt-get update</command>
</screen>
                </para>
                </listitem>
                <listitem>
                <para>
                <emphasis role="bold">Upgrade Packages</emphasis>: Over time, upgraded versions to packages currently installed on your computer may become available from the package repositories defined in your computer's repository listing.  To upgrade a  <emphasis role="italics">single</emphasis> package, you should first update your package index as outlined above, and then proceed to upgrading the packages with the following command entered at a terminal prompt:
<screen>
<command>sudo apt-get upgrade</command>
</screen>
                </para>
                <para>
                If you need to upgrade a complex package with dependencies, then another possibility for upgrades exists in the <emphasis role="italics">dist-upgrade</emphasis> parameter, which uses an intelligent dependency resolution system to adjust any new dependencies during the upgrade process.  
                </para>
                <para>
                Also, you may upgrade your entire Ubuntu system from one revision to another with dist-upgrade.  For example, to upgrade from Ubuntu version 5.10, to version 6.04, you would first ensure the version 6.04 repositories replace the existing 5.10 repositories in your computer's <filename>/etc/apt/sources.list</filename>, then simply issue the <application>apt-get update</application> command as detailed above, and finally, perform the actual upgrade by issuing the following command at a terminal prompt:
<screen>
<command>sudo apt-get dist-upgrade</command>
</screen>               
                </para>
                <para>
                After a fairly considerable amount of time, your computer will be upgraded to the new revision. Typically, some post-upgrade steps would be required as detailed in the upgrade notes for the revision you are upgrading to.
                </para>
                <para>
                Actions of the <application>apt-get</application> command, such as installation, and removal of packages are logged in the /var/log/dpkg.log log file.
                </para>
                </listitem>
        </itemizedlist>
        </para>
  </sect1>
  <sect1 id="synaptic" status="writing">
	<title>Synaptic</title>
        <para>
        Synaptic is a graphical front-end to the Advanced Package Tool (APT) system which provides a simple interface to package management for those who are either new to Ubuntu, or not accustomed to the terminal, command-line utilities, and editing configuration files directly.
        </para>
        <para>
        Synaptic provides all the required features for managing packages on your Ubuntu computer, from search facilities to locate packages, to installation, to upgrade of packages.  You may also maintain the repository list in Synaptic, including adding, and removing repositories.
        </para>
        <para>
        When launching Synaptic via the <emphasis role="italics">System</emphasis> > <emphasis role="italics">Administration</emphasis> > <emphasis role="italics">Synaptic Package Manager</emphasis> Menus, you are prompted for your user password.  This is required to open Synaptic as the 'root' user, who in turn, has the authority to carry out all of the related package management functions.
        </para>
        <para>
        After entering your user password correctly, Synaptic should open as a window, titled <emphasis role="bold">Synaptic Package Manager</emphasis>, and comprised of four major sections, consisting of a tool-bar at top, a list of package categories in the left pane, a list of packages in the top right pane, and finally, a package information pane at bottom right.
        </para>
        <para>
        Using Synaptic is very simple.  Some examples of the most popular uses for Synaptic:
        </para>
        <itemizedlist>
               <listitem>
                <para>
                <emphasis role="bold">Search Packages</emphasis>: To search for a particular package, simply click the <emphasis role="italics">Search</emphasis> icon in the tool-bar, enter a search string into the <emphasis role="italics">Search</emphasis> text input field, and optionally change the target of the search via the <emphasis role="italics">Look in</emphasis> drop-down menu. Click the <emphasis role="italics">Search</emphasis> button to begin searching.
                </para>
                </listitem>
                <listitem>
                <para>
                <emphasis role="bold">Install Packages</emphasis>: To install a package with Synaptic, simply click on the name of the package in the package listing pane at top right, and either click the <emphasis role="italics">Package</emphasis> > <emphasis role="italics">Mark for installation</emphasis> menu entry, or right-click the highlighted package name, and select the <emphasis role="italics">Mark for installation</emphasis> context menu entry. After marking the package for installation, click the <emphasis role="italics">Apply</emphasis> icon in the toolbar to actually commence with installation.
                </para>
                <note>
                <para>
                When marking a package for installation which has dependencies, an additional window will appear which asks for confirmation to mark the dependency packages for installation as well. To ensure the proper dependency packages are also installed, you should click the <emphasis role="italics">Mark</emphasis> button.
                </para>
                </note>
                </listitem>
                <listitem>
                <para>
                <emphasis role="bold">Remove Packages</emphasis>: To remove a package with Synaptic, simply click on the name of the installed package in the package listing pane at top right, and either click the <emphasis role="italics">Package</emphasis> > <emphasis role="italics">Mark for Removal</emphasis> menu entry,to remove the package, but leave associated configuration  files, or click the <emphasis role="italics">Package</emphasis> > <emphasis role="italics">Mark for Complete Removal</emphasis> menu entry to completely remove the package and all associated files.
                </para>
                <para>
                You may use the right-click context menus in the same way, for example by right-clicking the highlighted package name, and selecting the <emphasis role="italics">Mark for Removal</emphasis> context menu entry. After marking the package for removal, click the <emphasis role="italics">Apply</emphasis> icon in the toolbar to actually commence with removal.
                </para>
                <note>
                <para>
                When marking a package for removal which has dependencies, an additional window will appear which asks for confirmation to mark the dependency packages for removal as well. To ensure removal of dependency packages which are no longer necessary, you should click the <emphasis role="italics">Mark</emphasis> button.
                </para>
                </note>
                </listitem>
                <listitem>
                <para>
                <emphasis role="bold">Update Package Index</emphasis>: To update the package index information with Synaptic, click the <emphasis role="italics">Edit</emphasis> > <emphasis role="italics">Reload Package Information</emphasis> menu entry, or the <emphasis role="italics">Reload</emphasis> icon in the toolbar. 
                </para>
                </listitem>
                <listitem>
                <para>
                <emphasis role="bold">Upgrade Packages</emphasis>: To upgrade all packages which are currently considered candidates for upgrading, simply click the <emphasis role="italics">Mark All Upgrades</emphasis> icon in the toolbar, and then click the <emphasis role="italics">Apply</emphasis> icon in the toolbar. 
                </para>
                </listitem>
            </itemizedlist>
            <para>
            Synaptic keeps a history of all activities it performs.  To view the Synaptic history, simply click the <emphasis role="italics">File</emphasis> > <emphasis role="italics">History</emphasis> menu, then select the Month you wish to view information for in the left pane with the arrow control.  you may also search for specific history information with the Find feature, by entering a search string into the text input field, and clicking the <emphasis role="italics">Find</emphasis> button.
            </para>
            </sect1>
	<sect1 id="gai" status="writing">
		<title>GAI</title>
          <para>
            <!-- Is this General Applet Interface, and if so, what kind of context and treatment of it is required here?  If not, what is this GAI referrinf to? -->
          </para>
    </sect1>
	<sect1 id="configuration" status="writing">
		<title>Configuration</title>
          <para>
          <!-- Should this section be deiscussing the configuration of repositories via /etc/apt/sources.list, or configuration of APT via /etc/apt.conf, or both?
          
          Configuration of the Advanced Package Tool (APT) system repositories is handled by the /etc/apt/sources.list configuration file.
          -->
          </para>
    </sect1>
	<sect1 id="extra-repositories" status="review">
		<title>Extra Repositories</title>
          <para>
          In addition to the official supported package repositories available for Ubuntu, there exist additional community-maintained repositories which add thousands more potential packages for installation.  Two of these additional repositories are most popular, and are referred to as the <emphasis role="italics">Universe</emphasis>, and <emphasis role="italics">Multiverse</emphasis> repositories respectively. These repositories are not officially supported by Ubuntu, which is why they are not enabled by default, but they generally provide packages which are safe for use with your Ubuntu computer.
          </para>
          <para>
          Many other package sources are available, sometimes even offering only one package, as in the case of package sources provided by the developer of a single application.  You should always be very careful, and cautious when using non-standard package sources, however.  Research the source, and packages carefully before performing any installation, as some package sources, and their packages could render your system unstable, or non-functional in some respects.
          </para>
          <para>
          While detailing the process for adding extra repositories is beyond the scope of this guide, information concerning the process is available both for users of the Synaptic package manager, and for those who prefer to edit the <filename>/etc/apt/sources.list</filename> file directly from the References for this section.
          </para>
          <sect2 id="extra-repositories-references" status="review">
                <title>References</title>
                <para>
                <ulink url="https://wiki.ubuntu.com/AddingRepositoriesHowto">Adding Repositories Howto (Ubuntu Wiki)</ulink>
                </para>
          </sect2>
    </sect1>
	</chapter>
