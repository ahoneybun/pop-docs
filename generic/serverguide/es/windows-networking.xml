<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE chapter PUBLIC "-//OASIS//DTD DocBook XML V4.3//EN" 
	"http://www.oasis-open.org/docbook/xml/4.3/docbookx.dtd" [
<!ENTITY % globalent SYSTEM "../../../libs/global.ent">
%globalent;
<!ENTITY % genericent SYSTEM "../../libs/generic.ent">
%genericent;
<!ENTITY % cdo-C SYSTEM "../../../libs/cdo-C.ent">
%cdo-C;
<!ENTITY % gnome-menus-C SYSTEM "../../../ubuntu/libs/gnome-menus-C.ent">
%gnome-menus-C;
<!ENTITY % xinclude SYSTEM "../../../libs/xinclude.mod">
%xinclude;
<!ENTITY language "&EnglishAmerican;">
<!ENTITY ubuntu '<phrase>Ubuntu</phrase>'>
]>
<chapter id="windows-networking" status="complete">
	<title>Redes Windows</title>
  <para>Las redes de computadores a menudo se componen de sistemas diversos, y aunque sería ciertamente divertido trabajar con una red compuesta enteramente por equipos Ubuntu de servidor y escritorio, algunos entornos de red deben estar compuestos de sistemas Ubuntu y <trademark class="registered">Microsoft</trademark> 
  <trademark class="registered">Windows</trademark> trabajando juntos en armonía. Esta sección de &ubuntu; &sg-title; introduce los principios y las herramientas utilizadas para configurar su servidor Ubuntu para compartir recursos de red con equipos Windows.</para>
	<sect1 id="windows-networking-introduction" status="complete">
		<title>Introducción</title>
          <para>El trabajo en red con su sistema Ubuntu junto con clientes Windows implica la provisión e integración de los servicios comunes a los entornos Windows. Estos servicios ayudan en la compartición de datos e información acerca de los equipos y usuarios implicados en la red, y pueden clasificarse en tres grandes categorías de funcionalidad:</para>
          <itemizedlist>
             <listitem>
             <para><emphasis role="bold">Compartir impresoras y archivos</emphasis>. Se utiliza el protocolo Server Message Block (SMB) para facilitar la compartición de archivos, directorios, volúmenes e impresoras a través de la red.</para>
             </listitem>
             <listitem>
             <para><emphasis role="bold">Servicios de Directorio</emphasis>. Comparten información vital de los equipos y usuarios de la red con las tecnologías Lightweight Directory Access Protocol (LDAP) y Microsoft <trademark class="registered">Active Directory</trademark>.</para>
             </listitem>
             <listitem>
             <para><emphasis role="bold">Autenticación y acceso</emphasis>. Establecen la identidad de un equipo o usuario de la red y determinan la información a la que el equipo o el usuario está autorizado a acceder usando principios y tecnologías como permisos de archivos, políticas de grupos y el servicio de autentificación Kerberos.</para>
             </listitem>
          </itemizedlist>
          <para>Afortunadamente, su sistema Ubuntu puede proporcionar tales facilidades a clientes Windows y compartir recursos de red con ellos. Una de las principales piezas de software que incluye su sistema Ubuntu para trabajar con redes Windows es el paquete Samba de herramientas y aplicaciones de servidor SMB. Esta sección de la &sg-title; de &ubuntu; le introduce brevemente en la instalación y la configuración básica del paquete Samba de utilidades y aplicaciones de servidor. Una documentación o información más detallada sobre SAMBA queda fuera del ámbito de este documento, pero puede encontrarla en <ulink url="http://www.samba.org">el sitio web de Samba</ulink>.</para>
    </sect1>
	<sect1 id="installing-samba" status="complete">
		<title>Instalar SAMBA</title>
          <para>Introduzca la siguiente orden en la línea de órdenes para instalar las aplicaciones del servidor SAMBA:</para>
          <para>
<screen>
<command>sudo apt-get install samba</command>
</screen>
           </para> 
    </sect1>
	<sect1 id="configuring-samba" status="complete">
		<title>Configurar SAMBA</title>
          <para>Puede configurar el servidor SAMBA editando el archivo <filename>/etc/samba/smb.conf</filename> para cambiar las configuraciones por defecto o añadir algunas nuevas. Puede ver  más información sobre cada entrada de este archivo en los comentarios del archivo <filename>/etc/samba/smb.conf</filename> o en la página del manual de <filename>/etc/samba/smb.conf</filename> usando la siguiente orden en una terminal:</para>
           <para>
<screen>
<command>man smb.conf</command>
</screen>
           </para>
            <tip>
               <para>Antes de editar el archivo de configuración, debería hacer una copia del original y protegerla contra escritura para tener las configuraciones originales como referencia y reutilizarlas si fuese necesario.</para>
            </tip>
           <para>Haga una copia de seguridad del archivo <filename>/etc/samba/smb.conf</filename> :</para>
             <para>
<screen>
<command>sudo cp /etc/samba/smb.conf  /etc/samba/smb.conf.original</command>
</screen>
             </para> 
          <para>Ahora, edite el archivo <filename>/etc/samba/smb.conf</filename> y haga los cambios que necesite.</para> 
      <sect2 id="windows-networking-server" status="complete">
        <title>Servidor</title>
          <para>Además del paquete SAMBA de aplicaciones de servidor para compartir archivos e impresoras, Ubuntu también incluye otras potentes aplicaciones de red diseñadas para proporcionar funcionalidad adicional de servidor de red a los clientes Windows, similar a la funcionalidad proporcionada por los servidores Windows reales. Por ejemplo, Ubuntu proporciona una gestión centralizada de los recursos de red (como p.ej. equipos y usuarios) a través de los Servicios de Directorio, y facilita la identificación y la autorización de equipos y usuarios a través de los Servicios de Autenticación.</para>
           <para>Las siguientes secciones discutirán con mayor detalle SAMBA y las tecnologías de soporte, como el servidor LDAP (Lightweight Directory Access Protocol, Protocolo Ligero de Acceso a Directorios), y el servidor de autenticación Kerberos. También conocerá algunas de las directivas de configuración disponibles en el archivo de configuración de SAMBA, lo que le facilitará la integración en la red con clientes y servidores Windows.</para>
        <sect3 id="active-directory" status="complete">
          <title>Active Directory</title>
            <para>Active Directory es una implementación propietaria (creada por Microsoft) de los Servicios de Directorio, y proporciona una manera de compartir información entre recursos y usuarios de la red. Además de proporcionar una fuente centralizada para esa información, Active Directory también funciona como autoridad de seguridad centralizada de autenticación para la red. Active Directory combina capacidades que tradicionalmente se hallaban en sistemas separados y especializados de directorio, como integración simplificada, gestión y seguridad de los recursos de la red. El paquete SAMBA puede configurarse para usar los servicios de Active Directory desde un controlador de dominio de Windows.</para>
            <sect4 id="ldap" status="complete">
              <title>LDAP</title>
              <para>La aplicación de servidor LDAP proporciona funcionalidad de Servicios de Directorio a ordenadores Windows de una forma muy similar a los servicios de Microsoft Active Directory. Tales servicios incluyen gestionar las identidades y las relaciones entre los equipos, usuarios y grupos de equipos o usuarios que participan en la red, y proporcionan una forma consistente de describir, localizar y gestionar esos recursos. La implementación de libre distribución disponible en su sistema Ubuntu se llama <emphasis role="italic">OpenLDAP</emphasis>. Los demonios de servidor responsables de gestionar las peticiones de directorio OpenLDAP, y la propagación de datos de directorio entre un servidor LDAP y otro en Ubuntu, son <application>slapd</application> y <application>slurpd</application>. OpenLDAP puede usarse junto con SAMBA para proporcionar servicios de Archivo, Impresión y Directorio prácticamente de la misma forma que un Controlador de Dominio de Windows, si se compila SAMBA con soporte LDAP.</para>
            </sect4>
            <sect4 id="kerberos" status="complete">
              <title>Kerberos</title>
              <para>El sistema de autenticación de seguridad Kerberos es un servicio estandarizado que proporciona autenticación a equipos y usuarios por medio de un servidor centralizado que concede tickets de autorización cifrados aceptados para la autorización por cualquier otro equipo que use Kerberos. Los beneficios de la autenticación Kerberos incluyen autenticación mutua, autenticación delegada, interoperabilidad y gestion simplificada de confianzas. Los demonios de servidor primarios para gestionar la autenticación y la administración de la base de datos Kerberos en Ubuntu son <application>krb5kdc</application> y <application>kadmin</application>. SAMBA puede usar Kerberos como mecanismo de autenticación de equipos y usuarios contra un Controlador de Dominio de Windows. Para ello, el sistema Ubuntu debe tener instalado Kerberos, y se debe modificar el <filename>/etc/samba/smb.conf</filename> para seleccionar el <emphasis role="italic">reino</emphasis> adecuado y el modo de <emphasis role="italic">seguridad</emphasis>. Por ejemplo, edite el archivo <filename>/etc/samba/smb.conf</filename> y añada los valores:</para>
                 <para>
                 <emphasis role="bold">realm = NOMBRE_DE_DOMINIO</emphasis>
                 </para>
                 <para>
                 <emphasis role="bold">secutiry = ADS</emphasis>
                 </para>
                 <para>en el archivo, y guarde el archivo.</para>
                    <tip>
                       <para>Asegúrese de sustituir el NOMBRE_DE_DOMINIO del ejemplo de arriba con el nombre real de su Dominio Windows.</para>
                    </tip>
                 <para>Necesitará reiniciar los demonios de SAMBA para hacer efectivos estos cambios. Reinicie los demonios de SAMBA introduciendo los siguientes comandos en una linea de comandos:</para>
                    <para>
<screen>
<command>sudo /etc/init.d/samba restart</command>
</screen>
                    </para>
            </sect4>
        </sect3>
        <sect3 id="computer-accounts" status="complete">
          <title>Cuentas de equipo</title>
            <para>Los Servicios de Directorio usan las Cuentas de Equipo para identificar de forma única a los equipos que participan en una red, e incluso las tratan de la misma manera que a los usuarios en términos de seguridad. Las cuentas de equipo pueden tener contraseñas como las cuentas de usuario, y están sujetas a autorización sobre los recursos de red de la misma forma que las cuentas de usuario. Por ejemplo, si un usuario de la red, con una cuenta válida para una red en particular, intenta autenticarse sobre un recurso de red desde un equipo que no tiene una cuenta de equipo válida, dependiendo de las políticas aplicadas en la red, al usuario se le puede denegar el acceso al recurso si el equipo desde el que usuario está intentando autenticar se considera un equipo no autorizado.</para>
            <para>Las cuentas de equipo pueden añadirse al archivo de contraseñas de SAMBA, siempre que el nombre del equipo que se está añadiendo exista como una cuenta de usuario válida en la base de datos local de contraseñas. La sintaxis para añadir una cuenta de equipo o máquina al archivo de contraseñas de SAMBA es usar la orden <application>smbpasswd</application> desde la línea de órdenes de una terminal de la siguiente forma:</para>
               <para>
<screen>
<command>sudo smbpasswd -a -m NOMBRE_EQUIPO</command>
</screen>
               </para>
                  <tip>
                      <para>Asegurese de reemplazar la expresión NOMBRE_EQUIPO del ejemplo superior con el nombre real del equipo al que usted desea crear una cuenta.</para>
                   </tip>
        </sect3>
        <sect3 id="file-permissions" status="complete">
          <title>Permisos de archivo</title>
            <para>Los Permisos de Archivo definen los derechos explícitos que un equipo o usuario tiene sobre un directorio, archivo o conjunto de archivos particular. Tales permisos puden definirse editando el archivo <filename>/etc/samba/smb.conf</filename> y especificando los permisos explícitos de un recurso compartido dado. Por ejemplo, si tiene definido un recurso compartido SAMBA llamado <emphasis role="italic">sourcedocs</emphasis> y desea conceder sobre él permisos de <emphasis role="italic">sólo lectura (read-only)</emphasis> al grupo de usuarios llamado <emphasis role="italic">planning</emphasis>, pero al mismo tiempo quiere permitir la escritura sobre el recurso al grupo llamado <emphasis role="italic">autores</emphasis> y al usuario llamado <emphasis role="italic">ricardo</emphasis>,  entonces podría editar el archivo <filename>/etc/samba/smb.conf</filename> y añadir las siguientes entradas bajo la entrada <emphasis role="italic">[sourcedocs]</emphasis>:</para>
               <para>
                  <emphasis role="bold">read list = @planning</emphasis>
               </para>
               <para>
                  <emphasis role="bold">write list = @authors, richard</emphasis>
               </para>
             <para>Guardar los cambios de <filename>/etc/samba/smb.conf</filename> para que los cambios surtan efecto.</para>
            <para>Otro posible permiso consiste en declarar permisos <emphasis role="italic">administrativos</emphasis> sobre un recurso compartido en particular. Los usuarios que posean permisos administrativos podrán leer, escribir o modificar cualquier información contenida en el recurso sobre el que el usuario tenga concedidos los permisos administrativos. Por ejemplo, si desea que el usuario <emphasis role="italic">melissa</emphasis> posea permisos administrativos al recurso compartido <emphasis role="italic">sourcedocs</emphasis>, puede editar el archivo <filename>/etc/samba/smb.conf</filename> y añadir la siguiente línea debajo de la entrada <emphasis role="italic">[sourcedocs]</emphasis>:</para>
               <para>
                  <emphasis role="bold">admin users = melissa</emphasis>
               </para>
             <para>Guardar los cambios de <filename>/etc/samba/smb.conf</filename> para que los cambios surtan efecto.</para>
        </sect3>
      </sect2>
      <sect2 id="windows-networking-clients" status="complete">
        <title>Clientes</title>
          <para>Ubuntu incluye aplicaciones cliente y la capacidad de acceder a recursos compartidos de red con el protocolo SMB. Por ejemplo, la utilidad llamada <application>smbclient</application> permite el acceso a sistemas de archivos remotos compartidos, de una manera similar al cliente para el Protocolo de Transferencia de Ficheros (FTP). Para acceder a una carpeta compartida llamada <emphasis role="italic">documentos</emphasis> proporcionado por un equipo Windows llamado <emphasis role="italic">bill</emphasis> usando por ejemplo <application>smbclient</application>, debería introducir una orden similar a la siguiente en la línea de órdenes:</para>
                <para>
<screen>
<command>smbclient //bill/documentos -U &lt;nombredeusuario&gt;</command>
</screen>
                </para>
            <para>Se le solicitará la contraseña del usuario especificado en la opción -U, y si la autenticación tiene éxto, se le presentará un intérprete donde podrá introducir órdenes para manipular y transferir archivos en un contexto similar al usado por clientes FTP no-gráficos. Para más información sobre la herramienta <application>smbclient</application>, lea la página del manual de la herramienta con la orden: <screen>
<command>
man smbclient
</command>
</screen></para>
            <para>El montaje local de recursos remotos de red usando el protocolo SMB también es posible utilizando la orden <application>mount</application>. Por ejemplo, para montar una carpeta compartida llamada <emphasis role="italic">codigo-proyecto</emphasis> en un servidor Windows llamado <emphasis role="italic">desarrollo</emphasis> con el usuario <emphasis role="italic">dlightman</emphasis> en el punto de montaje /mnt/pcode de su sistema Ubuntu, usted debe introducir la siguiente orden en la línea de órdenes:</para>
                <para>
<screen>
<command>mount -t smbfs -o username=dlightman //desarrollo/codigo-proyecto /mnt/pcode</command>
</screen>
                </para>
                <para>Después se le solicitará la contraseña del usuario, y después de una autenticación satisfactoria, el contenido del recurso compartido estará disponible localmente por medio del punto de montaje especificado como último argumento en la orden mount. Para desconectarse del recurso compartido, simplemente use la orden <application>umount</application> como usted haría con otros puntos de montaje de su sistema de archivos. Por ejemplo:</para>
                <para>
<screen>
<command>umount /mnt/pcode</command>
</screen>
                </para>
        <sect3 id="user-accounts" status="complete">
          <title>Cuentas de usuario</title>
            <para>Las Cuentas de Usuario definen las personas que tienen algún nivel de autorización para usar ciertos equipos y recursos de red. Normalmente, en un entorno de red se le proporciona una cuenta de usuario a cada persona a la que se le permite el acceso a un equipo o red, donde las políticas y los permisos definen qué a derechos específicos tiene acceso la cuenta de usuario. Para definir usuarios de una red SAMBA en su sistema Ubuntu, debe usar la orden <application>smbpasswd</application>. Por ejemplo, para añadir un usuario SAMBA a su sistema Ubuntu con el nombre de usuario <emphasis role="italic">jseinfeld</emphasis>, debe introducir lo siguiente en la línea de órdenes:</para>
                 <para>
<screen>
<command>smbpasswd -a jseinfeld</command>
</screen>
                 </para>
              <para>La aplicación <application>smbpasswd</application> le pedirá que introduzca una contraseña para el usuario:</para>
                 <para>
                    <computeroutput>
                    Nueva contraseña SMB:
                    </computeroutput>
                 </para>
              <para>Introduzca la contraseña que desea asignarle al usuario, y la aplicación <application>smbpasswd</application> le pedirá que la confirme:</para>
                    <para>
                    <computeroutput>
                    Vuelva a escribir la nueva contraseña SMB:
                    </computeroutput>
                     </para>
               <para>Confirme la contraseña, y <application>smbpasswd</application> añadirá la entrada para el usuario en el archivo de contraseñas de SAMBA.</para>
        </sect3>
        <sect3 id="windows-networking-groups" status="complete">
          <title>Grupos</title>
            <para>Los grupos definen una colección de equipos o usuarios que tienen un nivel común de acceso a recursos de red particulares, y proporcionan un nivel de granularidad para controlar el acceso a tales recursos. Por ejemplo, si se define un grupo <emphasis role="italic">qa</emphasis> que contiene los usuarios <emphasis role="italic">freda</emphasis>, <emphasis role="italic">danika</emphasis> y <emphasis role="italic">rob</emphasis>, y se define un segundo grupo <emphasis role="italic">soporte</emphasis> con los usuarios <emphasis role="italic">danika</emphasis>, <emphasis role="italic">jeremy</emphasis> y <emphasis role="italic">vincent</emphasis>, entonces los recursos de red configurados para permitir el acceso al grupo <emphasis role="italic">qa</emphasis> habilitarán en consecuencia el acceso a los usuarios freda, danika y rob, pero no a jeremy ni a vincent. Como el usuario <emphasis role="italic">danika</emphasis> pertenece a los dos grupos <emphasis role="italic">qa</emphasis> y <emphasis role="italic">support</emphasis> simultáneamente, podrá acceder a los recursos configurados para poder ser accedidos desde ambos grupos, mientras que los demás usuarios sólo tendrán acceso a los recursos para los que explícitamente tengan acceso los grupos a los que pertenecen tales usuarios.</para>
            <para>Al definir grupos en el archivo de configuración de SAMBA, <filename>/etc/samba/smb.conf</filename>, la sintaxis reconocida es anteponer al nombre del grupo el símbolo «@». Por ejemplo, si desea definir un grupo llamado <emphasis role="italic">sysadmin</emphasis> en alguna sección del archivo <filename>/etc/samba/smb.conf</filename>, lo podrá hacer introduciendo el nombre del grupo como <emphasis role="bold">@sysadmin</emphasis>.</para>
        </sect3>
        <sect3 id="group-policy" status="complete">
          <title>Políticas de grupo</title>
            <para>Las Políticas de Grupo definen ciertas configuraciones SAMBA para el dominio o grupo de trabajo al que pertenecen las cuentas de usuario, y otras configuraciones globales para el servidor SAMBA. Por ejemplo, si el servidor SAMBA pertenece a un grupo de trabajo de equipos Windows llamado <emphasis role="italic">NIVELUNO</emphasis>, se debe editar el archivo <filename>/etc/samba/smb.conf</filename> y cambiar el siguiente valor convenientemente:</para>
               <para>
               <emphasis role="bold">workgroup = NIVELUNO</emphasis>
               </para>
            <para>Guarde el archivo y reinicie el demonio SAMBA para que los cambios tengan efecto.</para>
            <para>Entre otras opciones importantes de política global está <emphasis role="italic">server string</emphasis>, que define el nombre de servidor NETBIOS que su sistema Ubuntu proporciona a las demás máquinas de la red basada en Windows. Este es el nombre por el que su sistema Ubuntu será reconocido por los clientes Windows y los demás equipos capaces de examinar la red con el protocolo SMB. Además, también puede especificar el nombre y la ubicación del archivo de registro del servidor SAMBA usando la directiva <emphasis role="italic">log file</emphasis> en el archivo <filename>/etc/samba/smb.conf</filename>.</para>
            <para>Algunas de las directivas adicionales que gobiernan la política global del grupo incluyen la especificación de la naturaleza global de todos los recursos compartidos. Por ejemplo, si se colocan ciertas directivas bajo la cabecera <emphasis role="italic">[global]</emphasis> del archivo <filename>/etc/samba/smb.conf</filename>, éstas afectarán a todos los recursos compartidos a menos que se coloque alguna directiva contradictoria que sustituya a la global en la cabecera particular de algún recurso compartido. Puede especificar que todos los recursos compartidos sean navegables por todos los clientes de la red colocando la directiva <emphasis role="italic">browseable</emphasis>, que recibe un argumento booleano, bajo la cabecera <emphasis role="italic">[global]</emphasis> del archivo <filename>/etc/samba/smb.conf</filename>. Es decir: si edita el archivo y añade la línea:</para>
            <para>
            <emphasis role="bold">browseable = true</emphasis>
            </para>
            <para>bajo la sección <emphasis role="italic">[global]</emphasis> del archivo <filename>/etc/samba/smb.conf</filename>, entonces todos los recursos compartidos suministrados por su sistema Ubuntu a través de SAMBA serán navegables por todos los clientes autorizados, a menos que exista algún recurso compartido específico que contenga una directiva <emphasis role="italic">browseable = false</emphasis>, lo que cancelaría la directiva global.</para>
            <para>Otros ejemplos que funcionan de una manera similar son las directivas <emphasis role="italic">public</emphasis> y <emphasis role="italic">writeable</emphasis>. La directiva <emphasis role="italic">public</emphasis> acepta un valor booleano y decide si un recurso compartido en particular será visible por todos los clientes, autorizados o no. La directiva <emphasis role="italic">writeable</emphasis> también acepta un valor booleano y define si un determinado recurso compartido podrá ser accedido para escritura por todos los clientes de la red.</para>
        </sect3>
      </sect2>
    </sect1>
	</chapter>

