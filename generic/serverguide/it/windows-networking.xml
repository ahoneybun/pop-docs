<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE chapter PUBLIC "-//OASIS//DTD DocBook XML V4.3//EN" 
	"http://www.oasis-open.org/docbook/xml/4.3/docbookx.dtd" [
<!ENTITY % globalent SYSTEM "../../../libs/global.ent">
%globalent;
<!ENTITY % genericent SYSTEM "../../libs/generic.ent">
%genericent;
<!ENTITY % cdo-C SYSTEM "../../../libs/cdo-C.ent">
%cdo-C;
<!ENTITY % gnome-menus-C SYSTEM "../../../ubuntu/libs/gnome-menus-C.ent">
%gnome-menus-C;
<!ENTITY % xinclude SYSTEM "../../../libs/xinclude.mod">
%xinclude;
<!ENTITY language "&EnglishAmerican;">
<!ENTITY ubuntu '<phrase>Ubuntu</phrase>'>
]>
<chapter id="windows-networking" status="complete">
	<title>Reti Windows</title>
  <para>Computer networks are often comprised of diverse systems, and while operating a network
  made up entirely of Ubuntu desktop and server computers would certainly be fun, some network environments
  must consist of both Ubuntu and <trademark class="registered">Microsoft</trademark> 
  <trademark class="registered">Windows</trademark> systems working together in harmony.  
  This section of the &ubuntu; &sg-title; introduces principles and tools used in 
  configuring your Ubuntu Server for sharing network resources with Windows computers.
  </para>
	<sect1 id="windows-networking-introduction" status="complete">
		<title>Introduzione</title>
          <para>Utilizzare Ubuntu in una rete composta da client Windows significa fornire e integrare i servizi tipici degli ambienti Windows. Questi servizi offrono supporto per la condivisione di dati e informazioni riguardo i computer e gli utenti della rete e possono essere classificati, in base alle loro funzionalità, in tre principali categorie:</para>
          <itemizedlist>
             <listitem>
             <para><emphasis role="bold">Servizi per la condivisione di file e stampanti</emphasis>. Utilizzo del protocollo SMB (Server Message Block) per agevolare la condivisione di file, cartelle, volumi e stampanti attraverso la rete.</para>
             </listitem>
             <listitem>
             <para><emphasis role="bold">Servizi di directory</emphasis>. Condivisione di informazioni vitali sui computer e sugli utenti della rete con l'uso di tecnologie come LDAP (Lightweight Directory Access Protocol) e Microsoft <trademark class="registered">Active Directory</trademark>.</para>
             </listitem>
             <listitem>
             <para><emphasis role="bold">Autenticazione e acesso</emphasis>. Stabilire l'identità del computer o dell'utente della rete e determinare quali risorse siano accessibili al computer o all'utente tramite i permessi e i privilegi, utilizzando permessi dei file, politiche di gruppo e il servizio di autenticazione Kerberos.</para>
             </listitem>
          </itemizedlist>
          <para>Fortunately, your Ubuntu system may provide all such facilities to Windows clients and share network resources among them.  
          One of the principle pieces of software your Ubuntu system includes for Windows networking is the SAMBA suite of SMB server applications
           and tools.  This section of the &ubuntu; &sg-title; will briefly introduce the installation and limited configuration of the SAMBA
           suite of server applications and utilities.  Additional, detailed documentation and information on SAMBA is beyond the scope of this
           documentation, but exists on the <ulink url="http://www.samba.org">SAMBA website</ulink>.
          </para>
    </sect1>
	<sect1 id="installing-samba" status="complete">
		<title>Installare SAMBA</title>
          <para>Al prompt inserire il seguente comando per installare le applicazioni server di SAMBA:</para>
          <para>
<screen>
<command>sudo apt-get install samba</command>
</screen>
           </para> 
    </sect1>
	<sect1 id="configuring-samba" status="complete">
		<title>Configurare SAMBA</title>
          <para>Il server SAMBA si configura attraverso la modifica del file <filename>/etc/samba/smb.conf</filename> per aggiungere o cambiare le impostazioni predefinite. Nei commenti del file <filename>/etc/samba/smb.conf</filename> l'utente può trovare altri dettagli sulla configurazione oppure consultando il manuale di <filename>/etc/samba/smb.conf</filename> digitando il seguente comando:</para>
           <para>
<screen>
<command>man smb.conf</command>
</screen>
           </para>
            <tip>
               <para>Prima di modificare il file di configurazione, è consigliato creare una copia del file originale e proteggerla dalla scrittura, in modo da mantenere le impostazioni originali a disposizione come riferimento e per il riuso secondo necessità.</para>
            </tip>
           <para>Fare una copia di backup del file <filename>/etc/samba/smb.conf</filename>:</para>
             <para>
<screen>
<command>sudo cp /etc/samba/smb.conf /etc/samba/smb.conf.original</command>
</screen>
             </para> 
          <para>Ora, aprire il file <filename>/etc/samba/smb.conf</filename> e apportare i cambiamenti desiderati.</para> 
      <sect2 id="windows-networking-server" status="complete">
        <title>Server</title>
          <para>In aggiunta alla suite SAMBA per la gestione di un server, con tutte le sue applicazioni, Ubuntu offre altre potenti applicazioni per aumentare le funzionalità dei servizi offerti ai client Windows, molto simili a quelli offerti dai server Windows. Ubuntu offre la gestione centralizzata delle risorse della rete con Directory Services e facilita l'identificazione e l'autorizzazione di computer o utenti mediante Authentication Serivces.</para>
           <para>Le seguenti sezioni trattano in dettaglio di SAMBA e delle tecnologie di supporto, quali server LDAP (Lightweight Directory Access Protocol) e server d'autenticazione Kerberos. Sono esposte anche alcune delle direttive di configurazione disponibili nel file di configurazione di SAMBA che possono facilitare l'integrazione in rete con client e server Windows.</para>
        <sect3 id="active-directory" status="complete">
          <title>Active Directory</title>
            <para>Active Directory è un'implementazione proprietaria di Microsoft di Directory Services in grado di fornire i mezzi necessari a condividere le informazioni sugli utenti e sulle risorse della rete. Oltre a offrire una sorgente centralizzata per queste informazioni, Active Directory agisce come autorità centrale per l'autenticazione nella rete. Active Directory combina le funzionalità di servizi di directory specializzati, in modo tale da semplificare l'integrazione, la gestione e la sicurezze delle risorse di rete. La suite SAMBA può essere configurata per utilizzare i servizi di Active Directory forniti da un Windows Domain Controller.</para>
            <sect4 id="ldap" status="complete">
              <title>LDAP</title>
              <para>Il server LDAP fornisce, in maniera molto simile ai servizi Microsoft Active Directory, le funzionalità dei Directory Services ai computer Windows: questi servizi forniscono i mezzi per descrivere, localizzare e gestire le risorse della rete. L'implementazione libera di LDAP disponibile in Ubuntu, si chiama <emphasis role="italic">OpenLDAP</emphasis>. I demoni del server, responsabili della gestione delle richieste di directory OpenLDAP e della distribuzione dei dati custoditi in un server LDAP in un altro sistema Ubuntu, si chiamano <application>slapd</application> e <application>slurpd</application>. OpenLDAP può essere utilizzato in combinazione con SAMBA per fornire Directory Services e la condivisione di file e stampanti, più o meno nello stesso modo con il quale un Windows Domain Controller interagisce con un server SAMBA compilato con il supporto LDAP.</para>
            </sect4>
            <sect4 id="kerberos" status="complete">
              <title>Kerberos</title>
              <para>Il sistema standard di autenticazione Kerberos è un servizio che fornisce autenticazione ai computer e agli utenti. Il servizio viene fornito attraverso un server centralizzato di autenticazione che garantisce biglietti d'accesso cifrati e accettati dai sistemi che operano con Kerberos. I benefici offerti da Kerberos sono la reciproca autenticazione, un'autenticazione per delega, interoperabilità e una gestione semplificata delle credenziali. I demoni principali in Ubuntu per la gestione dell'autenticazione Kerberos e l'amministrazione del database sono <application>krb5kdc</application> e <application>kadmin</application>. SAMBA può utilizzare Kerberos quale meccanismo di autenticazione dei computer e degli utenti in un ambiente controllato da un Windows Domain Controller. Per poter fare questo, il sistema Ubuntu deve avere installato Kerberos e il file <filename>/etc/samba/smb.conf</filename> deve essere predisposto per selezionare i corretti <emphasis role="italic">realm</emphasis> e <emphasis role="italic">security</emphasis>. Modificare, per esempio,
<filename>/etc/samba/smb.conf</filename> aggiungendo i valori:</para>
                 <para>
                 <emphasis role="bold">realm = NOME_DOMINIO</emphasis>
                 </para>
                 <para>
                 <emphasis role="bold">security = ADS</emphasis>
                 </para>
                 <para>al file, e quindi salvarlo.</para>
                    <tip>
                       <para>Assicurarsi di sostiutire il token NOME_DOMINIO, utilizzato nell'esempio precedente, con il nome del dominio Windows.</para>
                    </tip>
                 <para>Per rendere effettivi i cambiamenti apportati, è necessario riavviare i demoni SAMBA. Per riavviare i demoni SAMBA, inserire in un terminale il seguente comando:</para>
                    <para>
<screen>
<command>sudo /etc/init.d/samba restart</command>
</screen>
                    </para>
            </sect4>
        </sect3>
        <sect3 id="computer-accounts" status="complete">
          <title>Account computer</title>
            <para>Nei Directory Services gli account del computer sono utilizzati per identificare univocamente i computer presenti nella rete. Dal punto di vista della sicurezza sono trattati come degli account utente, pertanto possono avere delle password e sono soggetti ad autorizzazioni per l'accesso alle risorse di rete. Per esempio, se un utente con un account valido tenta di accedere a una risorsa da un computer che non possiede un account valido, a seconda delle politiche di sicurezza applicate, l'accesso alla risorsa potrebbe essere negato se il computer, dal quale l'utente sta effettuando l'autenticazione, non possiede le necessarie autorizzazioni.</para>
            <para>Un account del computer può essere aggiunto al database degli account di SAMBA fornendo il nome del computer, purché questo non sia già presente come account utente. Per aggiungere un account del computer al database degli account di SAMBA, utilizzare, in un terminale, il comando <application>smbpasswd</application>:</para>
               <para>
<screen>
<command>sudo smbpasswd -a -m NOME_COMPUTER</command>
</screen>
               </para>
                  <tip>
                      <para>Assicurarsi di sostituire il token NOME_COMPUTER, utilizzato nell'esempio precedente, con il nome del computer per il quale si vuole creare un account.</para>
                   </tip>
        </sect3>
        <sect3 id="file-permissions" status="complete">
          <title>Permessi dei file</title>
            <para>I permessi di accesso ai file indicano esplicitamente le operazioni consentite a un computer o a un utente su una particolare directory, un determinato file oppure un insieme di file. Questi permessi possono essere definiti modificando il file <filename>/etc/samba/smb.conf</filename> e specificando i permessi per una condivisione. Ad esempio, se l'utente ha definito una condivisione SAMBA chiamata <emphasis role="italic">sourcedocs</emphasis> e desidera concedere i permessi di <emphasis role="italic">sola lettura</emphasis> al gruppo <emphasis role="italic">pianificazione</emphasis>, concedendo però i permessi di <emphasis role="italic">scrittura</emphasis> al gruppo <emphasis role="italic">autori</emphasis> e all'utente <emphasis role="italic">mario</emphasis>, è necessario modificare il file <filename>/etc/samba/smb.conf</filename>, aggiungendo le seguenti righe al di sotto di <emphasis role="italic">[sourcedocs]</emphasis>:</para>
               <para>
                  <emphasis role="bold">read list = @pianificazione</emphasis>
               </para>
               <para>
                  <emphasis role="bold">write list = @autori, mario</emphasis>
               </para>
             <para>Salvare il file <filename>/etc/samba/smb.conf</filename> affinché i cambiamenti abbiano effetto.</para>
            <para>È inoltre possibile concedere permessi <emphasis role="italic">amministrativi</emphasis> per una particolare risorsa condivisa. Gli utenti che possiedono permessi amministrativi possono leggere, scrivere o modificare tutte le informazioni della risorsa per la quale hanno ottenuto i permessi. Per esempio, se si desidera concedere all'utente <emphasis role="italic">melissa</emphasis> i permessi amministrativi sulla condivisione <emphasis role="italic">sourcedocs</emphasis>, è necessario modificare il file <filename>/etc/samba/smb.conf</filename> aggiungendo le seguenti righe al di sotto di <emphasis role="italic">[sourcedocs]</emphasis>:</para>
               <para>
                  <emphasis role="bold">admin users = melissa</emphasis>
               </para>
             <para>Salvare il file <filename>/etc/samba/smb.conf</filename> affinché i cambiamenti abbiano effetto.</para>
        </sect3>
      </sect2>
      <sect2 id="windows-networking-clients" status="complete">
        <title>Client</title>
          <para>Ubuntu include funzionalità e applicazioni client per accedere alle risorse di rete condivise attraverso il protocollo SMB. Per esempio, mediante l'applicazione <application>smbclient</application>, è possibile accedere a file system remoti condivisi , come con un client FTP (File Transfer Protocol). Per accedere alla cartella condivisa <emphasis role="italic">documenti</emphasis>, nel computer remoto Windows denominato <emphasis role="italic">bill</emphasis> utilizzando <application>smbclient</application>, è sufficiente digitare al prompt dei comandi:</para>
                <para>
<screen>
<command>smbclient //bill/documenti -U &lt;nomeutente&gt;</command>
</screen>
                </para>
            <para>Viene richiesta la password per il nome utente specificato dopo l'argomento -U e, se l'autenticazione ha avuto successo, viene presentato un prompt in cui è possibile inserire i comandi per manipolare e trasferire i file, usando una sintassi simile a quella usata dai client FTP in modalità non grafica. Per maggiori informazioni sull'applicazione <application>smbclient</application>, leggere la corrispondente pagina di manuale utilizzando il comando: <screen>
<command>
man smbclient
</command>
</screen></para>
            <para>Utilizzando il protocollo SMB, è anche possibile montare localmente risorse remote attraverso il comando <application>mount</application>. Per esempio, per montare sul punto di mount /mnt/pcode del proprio sistema Ubuntu, con i permessi dell'utente <emphasis role="italic">giuseppe</emphasis>, la cartella condivisa chiamata <emphasis role="italic">codice-progetto</emphasis> che si trova sul server Windows <emphasis role="italic">sviluppo</emphasis>, è necessario digitare al prompt il seguente comando:</para>
                <para>
<screen>
<command>mount -t smbfs -o username=giuseppe //sviluppo/codice-progetto /mnt/pcode</command>
</screen>
                </para>
                <para>Viene richiesta la password dell'utente e, se l'autenticazione ha avuto successo, il contenuto della risorsa condivisa è disponibile, localmente, nel punto di mount specificato come ultimo argomento del comando di mount. Per scollegare la risorsa condivisa è sufficiente utilizzare il comando <application>umount</application>, come per ogni altro file system montato. Per esempio:</para>
                <para>
<screen>
<command>umount /mnt/pcode</command>
</screen>
                </para>
        <sect3 id="user-accounts" status="complete">
          <title>Account utente</title>
            <para>Gli account utenti definiscono gli utenti e il livello di autorizzazione all'utilizzo di un computer o delle risorse di rete concessi a quell'utente. È normale che in una rete ogni utente abbia un proprio account con cui vengono definiti i diritti e i permessi di accesso alle risorse. La definizione degli utenti SAMBA nel server Ubuntu avviene tramite l'uso di <application>smbpasswd</application>. Per esempio, per aggiungere un utente SAMBA al server Ubuntu, assegnandogli il nome <emphasis role="italic">jseinfeld</emphasis>, da terminale digitare:</para>
                 <para>
<screen>
<command>smbpasswd -a jsenfield</command>
</screen>
                 </para>
              <para>L'applicazione <application>smbpasswd</application> chiederà di inserire una password per l'utente:</para>
                 <para>
                    <computeroutput>
                    Nuova password SMB:
                    </computeroutput>
                 </para>
              <para>È necessario digitare la password da assegnare al nuovo utente, l'applicazione  <application>smbpasswd</application> ne chiederà la conferma:</para>
                    <para>
                    <computeroutput>
                    Ridigitare la nuova password SMB:
                    </computeroutput>
                     </para>
               <para>Confermata la nuova password, <application>smbpasswd</application> aggiungerà una nuova voce per l'utente nel file delle password di SAMBA.</para>
        </sect3>
        <sect3 id="windows-networking-groups" status="complete">
          <title>Gruppi</title>
            <para>I gruppi definiscono un insieme di computer e utenti che godono dei medesimi privilegi di accesso alle risorse condivise. I gruppi offrono un alto livello di controllo degli accessi alle risorse. Per esempio, se il gruppo <emphasis role="italic">qa</emphasis> contiene gli utenti <emphasis role="italic">freda</emphasis>, <emphasis role="italic">danika</emphasis> e <emphasis role="italic">rob</emphasis> e viene definito il secondo gruppo <emphasis role="italic">support</emphasis> che contiene gli utenti <emphasis role="italic">danika</emphasis>, <emphasis role="italic">jeremy</emphasis> e <emphasis role="italic">vincent</emphasis>, allora alcune risorse di rete impostate per concedere l'accesso al gruppo <emphasis role="italic">qa</emphasis> concedono automaticamente l'accesso anche agli utenti freda, danika e rob, mentre lo negano a jeremy o vincent. Dal momento che l'utente <emphasis role="italic">danika</emphasis> è membro di entrambi i gruppi <emphasis role="italic">qa</emphasis> e <emphasis role="italic">support</emphasis> potrà accedere a tutte le risorse condivise il cui accesso è stato concesso a entrambi i gruppi, gli altri utenti avranno accesso alle risorse esplicitamente assegnate al gruppo di appartenenza.</para>
            <para>Nella definizione dei gruppi nel file di configurazione di SAMBA <filename>/etc/samba/smb.conf</filename>, è necessario far precedere il nome del gruppo dal simbolo «@». Per definire un gruppo chiamato <emphasis role="italic">sysadmin</emphasis> in una certa sezione del file <filename>/etc/samba/smb.conf</filename> bisogna inserire il nome del gruppo come <emphasis role="bold">@sysadmin</emphasis>.</para>
        </sect3>
        <sect3 id="group-policy" status="complete">
          <title>Politiche di gruppo</title>
            <para>Le politiche di gruppo definiscono alcuni parametri della configurazione di SAMBA relativi al Dominio o al Gruppo di lavoro a cui appartengono degli account e ad altri parametri globali di configurazione del server di SAMBA. Se, per esempio, un server SAMBA appartiene a un Gruppo di lavoro Windows denominato <emphasis role="italic">LEVELONE</emphasis>, il file <filename>/etc/samba/smb.conf</filename> può essere modificato con il valore seguente:</para>
               <para>
               <emphasis role="bold">workgroup = LEVELONE</emphasis>
               </para>
            <para>Riavviare il demone SAMBA affiché le modifiche abbiano effetto.</para>
            <para>Altri importanti parametri di configurazione includono <emphasis role="italic">server string</emphasis> che definisce il nome del server NETBIOS dichiarato dal sistema Ubuntu alle altre macchine della rete Windows. Questo è il nome del sistema Ubuntu riconosciuto dai client Windows e dagli altri computer in grado di navigare con il protocollo SMB. È possibile specificare il nome e la posizione del file di log del server SAMBA utilizzando la direttiva <emphasis role="italic">log file</emphasis> all'interno del file <filename>/etc/samba/smb.conf</filename>.</para>
            <para>Alcune delle direttive che governano le politiche globali del gruppo includono dettagli della natura globale delle risorse condivise. Per esempio, inserendo alcune direttive al di sotto della sezione <emphasis role="italic">[global]</emphasis> nel file <filename>/etc/samba/smb.conf</filename>, queste influenzeranno tutte le relative risorse condivise fino a quando un'altra direttiva primaria non ne annulli l'effetto. È quindi possibile stabilire che tutte le risorse siano esplorabili dai client della rete collocando una direttiva <emphasis role="italic">browseable</emphasis>, che prevede un argomento booleano, sotto l'intestazione <emphasis role="italic">[global]</emphasis> del file <filename>/etc/samba/smb.conf</filename>. Quindi aggiungendo la riga:</para>
            <para>
            <emphasis role="bold">browseable = true</emphasis>
            </para>
            <para>sotto la sezione <emphasis role="italic">[global]</emphasis> del file <filename>/etc/samba/smb.conf</filename>, tutte la risorse condivisibili, fornite dal sistema Ubuntu attraverso SAMBA, saranno esplorabili dai client autorizzati, a meno che una specifica risorsa non contenga una direttiva <emphasis role="italic">browseable = false</emphasis> che scavalca le disposizioni impartite dalla direttiva globale.</para>
            <para>Altri esempi di direttive che operano in maniera simile alla precedente sono <emphasis role="italic">public</emphasis> e <emphasis role="italic">writeable</emphasis>. La direttiva <emphasis role="italic">public</emphasis> accetta un valore booleano per decidere se una particolare risorsa condivisa sia visibile a tutti i client autorizzati. Anche la direttiva <emphasis role="italic">writeable</emphasis> accetta un valore booleano per decidere se una particolare risorsa condivisa possa essere modificata o meno dai client della rete.</para>
        </sect3>
      </sect2>
    </sect1>
	</chapter>

