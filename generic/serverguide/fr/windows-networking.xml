<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE chapter PUBLIC "-//OASIS//DTD DocBook XML V4.3//EN" 
	"http://www.oasis-open.org/docbook/xml/4.3/docbookx.dtd" [
<!ENTITY % globalent SYSTEM "../../../libs/global.ent">
%globalent;
<!ENTITY % genericent SYSTEM "../../libs/generic.ent">
%genericent;
<!ENTITY % cdo-C SYSTEM "../../../libs/cdo-C.ent">
%cdo-C;
<!ENTITY % gnome-menus-C SYSTEM "../../../ubuntu/libs/gnome-menus-C.ent">
%gnome-menus-C;
<!ENTITY % xinclude SYSTEM "../../../libs/xinclude.mod">
%xinclude;
<!ENTITY language "&EnglishAmerican;">
<!ENTITY ubuntu '<phrase>Ubuntu</phrase>'>
]>
<chapter id="windows-networking" status="complete">
	<title>Réseaux Windows</title>
  <para>Les réseaux informatiques sont souvent composés de systèmes divers, et bien qu'un réseau uniquement composé d'ordinateurs de bureaux et de serveurs  Ubuntu soit certainement amusant, certains environnements réseaux comportent a la fois des ordinateurs sous Ubuntu et d'autres sous <trademark class="registered">Microsoft</trademark>
  <trademark class="registered">Windows</trademark> fonctionnant ensemble en harmonie. Cette section du &sg-title; &ubuntu; introduit les principes et outils utilisés pour la configuration de votre serveur Ubuntu et l'échange de ressources réseaux avec des ordinateurs sous Windows.</para>
	<sect1 id="windows-networking-introduction" status="complete">
		<title>Introduction</title>
          <para>Pour établir avec succès un réseau entre votre système Ubuntu et des clients Windows, il faut fournir et intégrer les services utilisés couramment dans les environnements Windows. Ces services permettent aux ordinateurs ey aux utilisateurs présents sur le réseau de partager de l'information et des données. Ils peuvent être classifiés en trois catégories principales selon leur fonctionnalité.</para>
          <itemizedlist>
             <listitem>
             <para><emphasis role="bold">Services de partage de fichiers et d'imprimantes</emphasis>. Utiliser le protocole Server Message Block (SMB) pour faciliter le partage de fichiers, de dossiers, de volumes et d'imprimantes à travers le réseau.</para>
             </listitem>
             <listitem>
             <para><emphasis role="bold">Services d'annuaire</emphasis>. Partager l'information vitale sur les ordinateurs et utilisateurs du réseau avec des technologies telles que le Lightweight Directory Access Protocol (LDAP) et le Microsoft <trademark class="registered">Active Directory</trademark>.</para>
             </listitem>
             <listitem>
             <para><emphasis role="bold">Authentification et accès</emphasis>. Établir l'identité d'un ordinateur ou d'un utilisateur et déterminer l'information à laquelle l'ordinateur ou l'utilisateur a l'autorisation d'accéder en utilisant des principes et technologies telles les droits d'accès sur les fichiers, les politiques de groupes, et le service d'authentification Kerberos.</para>
             </listitem>
          </itemizedlist>
          <para>Heureusement, votre système Ubuntu fournit tous ces outils pour partager des ressources réseaux avec des clients Windows. Une des principaux logiciels fourni avec Ubuntu est la suite d' applications SAMBA et le serveur SMB pour les réseaux Windows. Cette section du &sg-title; &ubuntu; vous explique rapidement l'installation et la configuration des applications et utilitaires serveur SAMBA. De la documentation plus détaillée à propos de SAMBA dépasse le but de ce guide mais existe sur <ulink url="http://www.samba.org">le site web de SAMBA</ulink>.</para>
    </sect1>
	<sect1 id="installing-samba" status="complete">
		<title>Installer SAMBA</title>
          <para>A l'invite système, entrez la commande suivante pour installer les applications serveur SAMBA :</para>
          <para>
<screen>
<command>sudo apt-get install samba</command>
</screen>
           </para> 
    </sect1>
	<sect1 id="configuring-samba" status="complete">
		<title>Configurer SAMBA</title>
          <para>Vous pouvez configurer le serveur SAMBA en éditant le fichier <filename>/etc/samba/smb.conf</filename> pour modifier les paramètres par défaut ou en ajouter de nouveaux. Des informations supplémentaires sur chaque paramètre sont disponibles dans les commentaires du fichier <filename>/etc/samba/smb.conf</filename> ou en regardant la page manuel du fichier <filename>/etc/samba/smb.conf</filename> en entrant la commande suivante dans un terminal :</para>
           <para>
<screen>
<command>man smb.conf</command>
</screen>
           </para>
            <tip>
               <para>Avant de modifier le fichier de configuration, vous devriez faire une copie du fichier originel et le protéger contre l'écriture pour avoir les paramètres originels comme référence et ainsi le réutiliser si nécessaire.</para>
            </tip>
           <para>Sauvegardez le fichier <filename>/etc/samba/smb.conf</filename> :</para>
             <para>
<screen>
<command>sudo cp /etc/samba/smb.conf /etc/samba/smb.conf.originel</command>
</screen>
             </para> 
          <para>Maintenant, éditez le fichier <filename>/etc/samba/smb.conf</filename> et faites vos modifications.</para> 
      <sect2 id="windows-networking-server" status="complete">
        <title>Serveur</title>
          <para>En supplément de la suite logicielle SAMBA pour le partage de fichiers et d'imprimantes, Ubuntu inclut aussi d'autres applications serveur puissantes destinées à fournir des fonctionnalités réseau supplémentaires et similaires à celles fournies par les serveurs Windows aux clients Windows. Par exemple, Ubuntu offre une gestion centralisée des ressources réseau telles que les ordinateurs ou les utilisateurs grâce à Directory Services (services d'annuaire), et facilite l'identification et la gestion des permissions des ordinateurs et des utilisateurs grâce à Authentication Services (services d'authentification).</para>
           <para>Les sections suivantes évoqueront plus en détails SAMBA et les technologies associées, telles que le serveur Lightweight Directory Access Protocol (LDAP) ou le serveur d'authentification Kerberos. Vous apprendrez aussi quelques directives de configuration disponibles pour SAMBA qui facilitent l'intégration dans un réseau comportant des clients et des serveurs Windows.</para>
        <sect3 id="active-directory" status="complete">
          <title>Active Directory</title>
            <para>Active Directory est une implémentation propriétaire de Microsoft des services d'annuaire et est utilisé pour partager l'information sur les ressources du réseau et ses utilisateurs. En plus de fournir une source centralisée de cette information, Active Directory agit aussi comme une autorité centralisée de sécurité et d'authentification pour le réseau. Active Directory, qui combine des capacités traditionnellement trouvées dans des systèmes d'annuaire distincts et spécialisés, simplifie l'intégration, la gestion et la sécurité des ressources réseau. Le paquet SAMBA peut être configuré pour utiliser les services Active Directory d'un contrôleur de domaine Windows.</para>
            <sect4 id="ldap" status="complete">
              <title>LDAP</title>
              <para>L'application serveur LDAP fournit les fonctionnalités de service d'annuaire (Directory Services) aux ordinateurs Windows d'une manière très similaire aux services Microsoft Active Directory. Ces services comprennent la gestion des identités et des relations entre ordinateurs, utilisateurs, et groupes d'ordinateurs ou d'utilisateurs qui font partie du réseau. Ils procurent une manière cohérente de décrire, localiser et gérer ces ressources. L'implémentation libre de LDAP disponible pour votre système Ubuntu se nomme <emphasis role="italic">OpenLDAP</emphasis>. Sur Ubuntu, les processus serveur responsables du traitement des requêtes OpenLDAP et de la propagation des données d'un serveur LDAP à un autre sont <application>slapd</application> et <application>slurpd</application>. OpenLDAP peut être utilisé conjointement avec SAMBA pour fournir les services de partage des fichiers, d'imprimantes et les services d'annuaire tout comme le ferait un contrôleur de domaine Windows pour autant que SAMBA soit compilé avec le support LDAP.</para>
            </sect4>
            <sect4 id="kerberos" status="complete">
              <title>Kerberos</title>
              <para>Le système de sécurisation des authentifications Kerberos est un service standardisé fournissant une authentification aux ordinateurs et aux utilisateurs grâce à un serveur centralisé qui accorde des tickets d'autorisation cryptés. Ceux-ci sont acceptés comme authentification par tout autre ordinateur utilisant Kerberos. Parmi les avantages de l'authentification avec Kerberos, on peut citer l'authentification réciproque, l'authentification par procuration, l'interopérabilité et une gestion simplifiée des relations de confiance. Les processus serveurs principaux qui gèrent l'authentification Kerberos et l'administration de la base de données Kerberos sous Ubuntu sont <application>krb5kdc</application> et <application>kadmin</application>. SAMBA peut utiliser Kerberos comme mécanisme pour authentifier des ordinateurs et des utilisateurs aux côtés d'un contrôleur de domaine Windows. À cette fin, il faut que Kerberos soit installé sur le système Ubuntu, et le fichier <filename>/etc/samba/smb.conf</filename> doit être modifié pour choisir le mode convenable de <emphasis role="italic">realm</emphasis> et <emphasis role="italic">security</emphasis>. Par exemple, modifiez le fichier <filename>/etc/samba/smb.conf</filename> et ajoutez les valeurs :</para>
                 <para>
                 <emphasis role="bold">realm = NOM_DOMAINE</emphasis>
                 </para>
                 <para>
                 <emphasis role="bold">security = ADS</emphasis>
                 </para>
                 <para>dans le fichier, et enregistrez-le.</para>
                    <tip>
                       <para>Assurez-vous de remplacer l'expression NOM_DOMAINE de l'exemple ci-dessus par le nom réel de votre propre domaine Windows.</para>
                    </tip>
                 <para>Vous devrez redémarrer les démons SAMBA pour appliquer ces changements. Redémarrez les démons SAMBA en entrant la commande suivante dans un terminal :</para>
                    <para>
<screen>
<command>sudo /etc/init.d/samba restart</command>
</screen>
                    </para>
            </sect4>
        </sect3>
        <sect3 id="computer-accounts" status="complete">
          <title>Comptes d'ordinateurs</title>
            <para>Les comptes d'ordinateur sont utilisés dans Directory Services pour identifier de manière unique les ordinateurs d'un réseau, et sont traités de la même manière que les utilisateurs en terme de sécurité. Les comptes d'ordinateurs peuvent avoir des mots de passe tout comme les comptes utilisateurs, et font l'objet d'une autorisation pour accéder aux ressources du réseau. Par exemple, si un utilisateur du réseau avec un compte valide pour un réseau en particulier essaye de s'authentifier à partir d'un ordinateur qui n'a pas de compte d'ordinateur valide, suivant la politique mise en œuvre sur le réseau, il peut lui être refusé l'accès si cet ordinateur ne fait pas partie des ordinateurs autorisés.</para>
            <para>Un compte d'ordinateur peut être ajouté au fichier de mots de passe SAMBA, pourvu que le nom de l'ordinateur à ajouter existe déjà comme un nom de compte d'utilisateur valide dans la base de données locale. Pour ajouter un compte d'ordinateur ou de machine au fichier de mots de passe SAMBA, il faut utiliser la commande <application>smbpasswd</application> dans un terminal comme ceci :</para>
               <para>
<screen>
<command>sudo smbpasswd -a -m NOM_ORDINATEUR</command>
</screen>
               </para>
                  <tip>
                      <para>Assurez-vous de remplacer la chaîne COMPUTER_NAME dans l'exemple ci-dessus avec le nom de l'ordinateur pour lequel vous voulez ajouter un compte de machine.</para>
                   </tip>
        </sect3>
        <sect3 id="file-permissions" status="complete">
          <title>Permissions de fichier</title>
            <para>Les permissions de fichiers définissent les droits explicites qu'un ordinateur ou un utilisateur a sur un dossier, fichier ou groupe de fichiers particulier. De telles permissions peuvent être définies en éditant le fichier <filename>/etc/samba/smb.conf</filename> et en spécifiant explicitement les permissions d'un partage de fichiers défini. Par exemple, si vous avez défini un partage SAMBA intitulé <emphasis role="italic">sourcedocs</emphasis> et souhaitez donner les droits en <emphasis role="italic">lecture seule</emphasis> au groupe d'utilisateurs appelé <emphasis role="italic">planning</emphasis>, mais souhaitez autoriser l'accès au partage en écriture par le groupe appelé <emphasis role="italic">auteurs</emphasis> et à l'utilisateur nommé <emphasis role="italic">richard</emphasis>, alors vous pouvez éditer le fichier <filename>/etc/samba/smb.conf</filename>, et ajouter les lignes suivantes sous l'entrée <emphasis role="italic">[sourcedocs]</emphasis> :</para>
               <para>
                  <emphasis role="bold">read list = @planning</emphasis>
               </para>
               <para>
                  <emphasis role="bold">write list = @auteurs, richard</emphasis>
               </para>
             <para>Sauvegardez <filename>/etc/samba/smb.conf</filename> pour que les changements prennent effet.</para>
            <para>Une autre possibilité pour les droits d'accès est de déclarer des permissions <emphasis role="italic">administratives</emphasis> pour une ressource partagée particulière. Les utilisateurs ayant des permissions administratives peuvent lire, écrire, ou modifier toute information contenue dans la ressource pour laquelle ils ont explicitement reçu ce type de droits. Par exemple, si vous voulez donner à l'utilisateur <emphasis role="italic">melissa</emphasis> des permissions administratives sur le partage <emphasis role="italic">sourcedocs</emphasis> de l'exemple, vous devez éditer le fichier <filename>/etc/samba/smb.conf</filename> et ajouter la ligne suivante sous l'entrée <emphasis role="italic">[sourcedocs]</emphasis> :</para>
               <para>
                  <emphasis role="bold">admin users = melissa</emphasis>
               </para>
             <para>Sauvegardez <filename>/etc/samba/smb.conf</filename> pour que les changements prennent effet.</para>
        </sect3>
      </sect2>
      <sect2 id="windows-networking-clients" status="complete">
        <title>Clients</title>
          <para>Ubuntu comporte des applications clientes et des capacités pour accéder aux ressources partagées grâce au protocole SMB. Par exemple, l'utilitaire nommé <application>smbclient</application> permet d'accéder aux systèmes de fichiers partagés à distance d'une façon similaire à un client FTP. Pour accéder à un répertoire partagé connu comme <emphasis role="italic">documents</emphasis>, proposé par un ordinateur sous Windows, nommé <emphasis role="italic">bill</emphasis>, on utilisera <application>smbclient</application>, avec une commande de ce type dans un terminal :</para>
                <para>
<screen>
<command>smbclient //bill/documents -U &lt;nomutilisateur&gt;</command>
</screen>
                </para>
            <para>Il vous sera alors demandé le mot de passe de l'utilisateur spécifié après le paramètre -U, et après la réussite de l'authentification, vous obtiendrez une invite vous permettant de manipuler ou transférer des fichiers avec une syntaxe semblable à celle d'un client FTP en mode texte. Pour plus d'informations sur l'utilitaire <application>smbclient</application>, consultez la page du manuel avec la commande : <screen>
<command>
man smbclient
</command>
</screen></para>
            <para>Le montage d'une ressource réseau fournie par le protocole SMB est aussi possible grâce à la commande <application>mount</application>. Par exemple, pour monter un répertoire nommé <emphasis role="italic">code-projet</emphasis> disponible sur un serveur Windows <emphasis role="italic">developpement</emphasis> pour l'utilisateur <emphasis role="italic">toto</emphasis> sur votre système Ubuntu dans le répertoire /mnt/pcode, vous devrez entrer la commande suivante à l'invite :</para>
                <para>
<screen>
<command>mount -t smbfs -o username=toto //developpement/code-projet- /mnt/pcode</command>
</screen>
                </para>
                <para>Il vous sera alors demandé d'entrer le mot de passe utilisateur, et après vous être authentifié, le contenu de la ressource partagée sera accessible localement via le point de montage spécifié par le dernier argument de la commande mount. Pour déconnecter la ressource partagée, utilisez simplement la commande <application>umount</application> comme vous le feriez avec n'importe quel autre système de fichiers monté. Par exemple :</para>
                <para>
<screen>
<command>umount /mnt/pcode</command>
</screen>
                </para>
        <sect3 id="user-accounts" status="complete">
          <title>Comptes d'utilisateurs</title>
            <para>Les comptes d'utilisateurs définissent des personnes avec un certain niveau d'autorisation pour utiliser un certain ordinateur et des ressources réseau. Typiquement, dans un environnement réseau, un compte d'utilisateur est fourni à chaque personne autorisée à accéder à un ordinateur ou à un réseau, où des politiques de sécurité et des permissions définissent alors de quels droits explicites ce compte d'utilisateur dispose. Pour définir des utilisateurs réseau SAMBA sur votre système Ubuntu, vous pouvez utiliser la commande <application>smbpasswd</application>. Par exemple, pour ajouter un utilisateur SAMBA à votre système Ubuntu avec le nom d'utilisateur <emphasis role="italic">toto</emphasis>, vous pourriez entrer ceci à l'invite de commande :</para>
                 <para>
<screen>
<command>smbpasswd -a toto</command>
</screen>
                 </para>
              <para>L'application <application>smbpasswd</application> vous demandera alors d'entrer un mot de passe pour l'utilisateur :</para>
                 <para>
                    <computeroutput>
                    Nouveau mot de passe SMB :
                    </computeroutput>
                 </para>
              <para>Entrez le mot de passe que vous désirez fixer pour l'utilisateur, et l'application <application>smbpasswd</application> vous demandera de confirmer le mot de passe:</para>
                    <para>
                    <computeroutput>
                    Retapez le nouveau mot de passe SMB :
                    </computeroutput>
                     </para>
               <para>Confirmez le mot de passe et <application>smbpasswd</application> ajoutera une entrée pour l'utilisateur au fichier de mots de passe SAMBA.</para>
        </sect3>
        <sect3 id="windows-networking-groups" status="complete">
          <title>Groupes</title>
            <para>Les Groupes définissent un ensemble d'ordinateurs ou d'utilisateurs qui ont un niveau d'accès commun à des ressources réseau particulières, et offrent une certaine granularité dans le contrôle d'accès à de telles ressources. Par exemple, si un groupe <emphasis role="italic">qa</emphasis> est défini et contient les utilisateurs <emphasis role="italic">freda</emphasis>, <emphasis role="italic">danika</emphasis>, et <emphasis role="italic">rob</emphasis>, et un second groupe <emphasis role="italic">support</emphasis> est défini et contient les utilisateurs <emphasis role="italic">danika</emphasis>, <emphasis role="italic">jeremy</emphasis> et <emphasis role="italic">vincent</emphasis>, alors certaines ressources réseau configurées pour autoriser l'accès au groupe <emphasis role="italic">qa</emphasis> autoriseraient par conséquent l'accès à freda, danika et rob, mais pas à jeremy ou à vincent. Comme l'utilisateur <emphasis role="italic">danika</emphasis> appartient aux deux groupes <emphasis role="italic">qa</emphasis> et <emphasis role="italic">support</emphasis>, elle sera capable d'accéder aux ressources configurées comme accessibles par les deux groupes, tandis que tous les autres utilisateurs n'auront accès qu'aux ressources autorisant explicitement le groupe dont ils font partie.</para>
            <para>Lors de la définition de groupes dans le fichier de configuration de SAMBA, <filename>/etc/samba/smb.conf</filename>, la syntaxe reconnue est l'ajout d'un préfixe "@" au nom de groupe. Par exemple, si vous souhaitez définir un groupe nommé <emphasis role="italic">sysadmin</emphasis> dans une certaine section du fichier <filename>/etc/samba/smb.conf, vous devez entrer le nom de groupe @sysadmin.</filename></para>
        </sect3>
        <sect3 id="group-policy" status="complete">
          <title>Stratégie de groupe</title>
            <para>Les stratégies de groupes définissent certains réglages de configuration SAMBA en rapport avec le domaine ou le groupe de travail auquel appartient le compte d'ordinateur, ainsi que d'autres réglages globaux du serveur SAMBA. Par exemple, si le serveur SAMBA appartient au groupe de travail Windows appelé <emphasis role="italic">NIVEAU1</emphasis>, le fichier <filename>/etc/samba/smb.conf</filename> pourrait alors être modifié de la manière suivante :</para>
               <para>
               <emphasis role="bold">workgroup = NIVEAU1</emphasis>
               </para>
            <para>Enregistrez le fichier et redémarrez les démons SAMBA pour appliquer le changement.</para>
            <para>D'autres réglages de stratégie globale importants comprennent la <emphasis role="italic">chaîne du serveur</emphasis> qui définit le nom serveur NETBIOS qui sera annoncé aux autres machines du réseau Windows par votre système Ubuntu. C'est le nom par lequel votre système Ubuntu sera reconnu par les clients Windows et d'autres ordinateurs capables de parcourir le réseau avec le protocole SMB. De plus, vous pouvez indiquer le nom et l'emplacement du fichier journal du serveur SAMBA en utilisant la directive <emphasis role="italic">log file</emphasis> dans le fichier <filename>/etc/samba/smb.conf</filename>.</para>
            <para>Quelques directives supplémentaires influençant la stratégie de groupe globale concernent la spécification de la nature globale des ressources partagées. Par exemple, l'emplacement de certaines directives sous la section <emphasis role="italic">[global]</emphasis> du fichier <filename>/etc/samba/smb.conf</filename> concernera toutes les ressources partagées, sauf si une directive identique remplace celle-ci sous la section d'une ressource partagée particulière. Vous indiquez que tous les partages peuvent être parcourus par tous les clients du réseau en plaçant la directive <emphasis role="italic">browseable</emphasis>, qui prend une valeur booléenne, sous la section <emphasis role="italic">[global]</emphasis> du fichier <filename>/etc/samba/smb.conf</filename>. C'est-à-dire que si vous modifiez le fichier en ajoutant la ligne :</para>
            <para>
            <emphasis role="bold">browseable = true</emphasis>
            </para>
            <para>sous la section <emphasis role="italic">[global]</emphasis> de <filename>/etc/samba/smb.conf</filename>, tous les partages offerts par votre système Ubuntu via SAMBA pourront être parcourus par tous les clients autorisés, sauf si un partage particulier contient une directive <emphasis role="italic">browseable = false</emphasis> qui prendra le pas sur la directive globale.</para>
            <para>Les directives <emphasis role="italic">public</emphasis> et <emphasis role="italic">writeable</emphasis> sont d'autres exemples qui fonctionnent de la même manière. La directive <emphasis role="italic">public</emphasis> prend une valeur booléenne et détermine si une ressource partagée particulière est visible par tous les clients, autorisés ou non. La directive <emphasis role="italic">writeable</emphasis> prend également une valeur booléenne et détermine si une ressource partagée particulière est accessible en écriture par n'importe quel client du réseau.</para>
        </sect3>
      </sect2>
    </sect1>
	</chapter>

