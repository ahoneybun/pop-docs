<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE chapter PUBLIC "-//OASIS//DTD DocBook XML V4.3//EN" 
	"http://www.oasis-open.org/docbook/xml/4.3/docbookx.dtd" [
<!ENTITY % globalent SYSTEM "../../../libs/global.ent">
%globalent;
<!ENTITY % genericent SYSTEM "../../libs/generic.ent">
%genericent;
<!ENTITY % cdo-C SYSTEM "../../../libs/cdo-C.ent">
%cdo-C;
<!ENTITY % gnome-menus-C SYSTEM "../../../ubuntu/libs/gnome-menus-C.ent">
%gnome-menus-C;
<!ENTITY % xinclude SYSTEM "../../../libs/xinclude.mod">
%xinclude;
<!ENTITY language "&EnglishAmerican;">
<!ENTITY ubuntu '<phrase>Ubuntu</phrase>'>
]>
<chapter id="windows-networking" status="complete">
	<title>Windowsnätverk</title>
  <para>Computer networks are often comprised of diverse systems, and while operating a network
  made up entirely of Ubuntu desktop and server computers would certainly be fun, some network environments
  must consist of both Ubuntu and <trademark class="registered">Microsoft</trademark> 
  <trademark class="registered">Windows</trademark> systems working together in harmony.  
  This section of the &ubuntu; &sg-title; introduces principles and tools used in 
  configuring your Ubuntu Server for sharing network resources with Windows computers.
  </para>
	<sect1 id="windows-networking-introduction" status="complete">
		<title>Introduktion</title>
          <para>För att använda Ubuntusystem tillsammans med Windowsklienter måste man använda tjänster som är vanliga i Windowsmiljöer. Sådana tjänster hjälper till att dela data och information om datorer och användare som är anslutna till nätverket. Dessa tjänster kan delas in tre huvudsakliga kategorier:</para>
          <itemizedlist>
             <listitem>
             <para><emphasis role="bold">Fil- och skrivardelning</emphasis>. Använder protokollet Server Message Block (SMB) för att dela filer, mappar, enheter och skrivare i nätverket.</para>
             </listitem>
             <listitem>
             <para><emphasis role="bold">Katalogtjänster</emphasis>. Delar kritisk information om datorer och användare i nätverket med hjälp av tekniker som Lightweight Directory Access Protocol (LDAP) och Microsoft <trademark class="registered">Active Directory</trademark>.</para>
             </listitem>
             <listitem>
             <para><emphasis role="bold">Autentisering och tillgång</emphasis>. Säkerställer identiteten hos en dator eller användare i nätverket och avgör vilken information som dator eller användaren har tillåtelse att nå med hjälp av policys och tekniker som filrättigheter, gruppolicys och autentiseringstjänsten Kerberos.</para>
             </listitem>
          </itemizedlist>
          <para>Fortunately, your Ubuntu system may provide all such facilities to Windows clients and share network resources among them.  
          One of the principle pieces of software your Ubuntu system includes for Windows networking is the SAMBA suite of SMB server applications
           and tools.  This section of the &ubuntu; &sg-title; will briefly introduce the installation and limited configuration of the SAMBA
           suite of server applications and utilities.  Additional, detailed documentation and information on SAMBA is beyond the scope of this
           documentation, but exists on the <ulink url="http://www.samba.org">SAMBA website</ulink>.
          </para>
    </sect1>
	<sect1 id="installing-samba" status="complete">
		<title>Installera SAMBA</title>
          <para>Vid en prompt, skriv följande kommando för att installera SAMBA:</para>
          <para>
<screen>
<command>sudo apt-get install samba</command>
</screen>
           </para> 
    </sect1>
	<sect1 id="configuring-samba" status="complete">
		<title>Konfigurera SAMBA</title>
          <para>Du kan konfigurera SAMBA-servern genom att redigera filen <filename>/etc/samba/smb.conf</filename>. Varje rad innehåller olika inställningar. Mer information om de olika inställningarna går att hitta i kommentarerna i filen eller genom att läsa manualsidan till filen som du får fram genom att skriva följande kommando i en terminalprompt:</para>
           <para>
<screen>
<command>man smb.conf</command>
</screen>
           </para>
            <tip>
               <para>Innan du redigerar konfigurationsfilen bör du se till att göra en kopia av originalfilen och skrivskydda den, så att du har kvar originalinställningarna dels som referens, och dels för återanvändning ifall det blir nödvändigt.</para>
            </tip>
           <para>Säkerhetskopiera filen <filename>/etc/samba/smb.conf</filename>:</para>
             <para>
<screen>
<command>sudo cp /etc/samba/smb.conf /etc/samba/smb.conf.original</command>
</screen>
             </para> 
          <para>Nu kan du redigera <filename>/etc/samba/smb.conf</filename> och göra de ändringar du vill göra.</para> 
      <sect2 id="windows-networking-server" status="complete">
        <title>Server</title>
          <para>Som ett komplement till SAMBA-sviten av fil- och skrivardelningsprogram innehåller även Ubuntu andra kraftfulla serverprogram, som är designade för att ge dig extra nätverksserverfunktioner för Windowsklienter som liknar de som finns i faktiska windowsservrar. Till exempel erbjuder Ubuntu centraliserad hantering av nätverksresurser, som datorerer och användare, via katalogtjänster, och tillåter identifiering av datorer via autentieringstjänster.</para>
           <para>Följande delar kommer att ta upp SAMBA och tillhörande tekniker såsom Lightweight Directory Access Protocol (LDAP) och Kerberos i mer detalj. Du kommer också lära dig om några av de konfigurationsdirektiv som går att använda i SAMBAs konfigurationsfil som låter dig integrera ditt Ubuntusystem med Windowsklienter och -servrar.</para>
        <sect3 id="active-directory" status="complete">
          <title>Active Directory</title>
            <para>Active Directory är en proprietär implementation av katalogtjänster från Microsoft, och den används för att erbjuda sätt att dela information om nätverksresurser och användare. Förutom att fungera som en central källa för sådan information kan Active Directory också agera som en central källa för autentisering i nätverket. Active Directory kombinerar alla de möjligheter man traditionellt hittar i separata, specialiserade katalogsystem, för att förenkla integrering, hantering och säkerhet för nätverksresurser. Paketet SAMBA går att konfigurera så att det använder Active Directory-tjänster från en Windows Domain Controller.</para>
            <sect4 id="ldap" status="complete">
              <title>LDAP</title>
              <para>Serverprogrammet LDAP erbjuder Windowsdatorer katalogtjänster som fungerar på nästan samma sätt som Microsofts Active Directory-tjänster. Bland dessa tjänster finns hantering av identiteter och relationer mellan datorer, användare, och grupper av datorer eller användare som deltar i nätverket, och erbjuder ett konsekvent sätt att beskriva, lokalisera och hantera dessa resurser. Den fritt tillgängliga implementationen av LDAP som finns tillgängligt för ditt Ubuntusystem kallas <emphasis role="italic">OpenLDAP</emphasis>. LDAP:s server-demoner som är ansvariga för att hantera katalogförfrågningar och överföring av katalogdata från en LDAP-server till en annan i Ubuntu heter <application>slapd</application> och <application>slurpd</application>. OpenLDAP går att användas tillsammans med SAMBA för att erbjuda fil-, utskrifts- och katalogtjänster på ungefär samma sätt som en Windows Domain Controller gör så länge SAMBA är kompilerats med LDAP-stöd.</para>
            </sect4>
            <sect4 id="kerberos" status="complete">
              <title>Kerberos</title>
              <para>Autentiseringssystemet Kerberos är en standardiserad tjänst för att erbjuda autentisering för datorer och användare genom en centraliserad server som beviljar krypterade biljetter, vilka accepteras som äkthetsbevis av alla andra datorer som använder Kerberos. Några fördelar med autentisering genom Kerberos är ömsesidig autentisering, delegerad autentisering, interoperabilitet och förenklad förtroendehantering. De vanligaste serverdemonerna som används för Kerberosautentisering och databashantering för Kerberos i Ubuntu är <application>krb5kdc</application> och <application>kadmin</application>. SAMBA kan använda Kerberos för att autentisera datorer och användare mot en Windows Domain Controller. För att göra det måste Ubuntusystemet ha Kerberos installerat, och <filename>/etc/samba/smb.conf</filename> måste ändras för att välja korrekt <emphasis role="italic">realm</emphasis> och läge för <emphasis role="italic">security</emphasis>. Till exempel, ändra filen <filename>/etc/samba/smb.conf</filename> och lägg till värdena:</para>
                 <para>
                 <emphasis role="bold">realm = DOMÄNNAMN</emphasis>
                 </para>
                 <para>
                 <emphasis role="bold">security = ADS</emphasis>
                 </para>
                 <para>till filen, och spara filen.</para>
                    <tip>
                       <para>Se till att du byter ut DOMÄNNAMN i ovastående exempel mot det riktiga namnet på din Windowsdomän.</para>
                    </tip>
                 <para>Du behöver starta om SAMBA-demoner för att dessa ändringar ska verkställas. Starta om SAMBA-demonerna genom att skriva följande kommando vid en terminalprompt:</para>
                    <para>
<screen>
<command>sudo /etc/init.d/samba restart</command>
</screen>
                    </para>
            </sect4>
        </sect3>
        <sect3 id="computer-accounts" status="complete">
          <title>Datorkonton</title>
            <para>Datorkonton används i katalogtjänster för att ge varje dator i nätverket en unik identitet, och de hanteras till och med på samma sätt som användare vad gäller säkerhet. Datorkonton kan ha lösenord precis som användarkonton, och måste identifiera sig för att komma åt nätverksresurser precis som användare. Till exempel, om en nätverksanvändare med ett giltigt konto för ett speciellt nätverk försöker identifiera sig mot en nätverksresurs från en dator som inte har ett giltigt datorkonto kan användaren komma att nekas tillgång till resursen, beroende på de policys som används på nätverket.</para>
            <para>Ett datorkonto går att lägga till SAMBA:s lösenordsfil, förutsatt att namnet på datorn som läggs till redan är ett giltigt användarkonto i den lokala lösenordsdatabasen först. För att lägga till ett dator- eller maskinkonto till SAMBAs lösenordsfil används kommandot <application>smbpasswd</application> i en terminal såhär:</para>
               <para>
<screen>
<command>sudo smbpasswd -a -m DATORNAMN</command>
</screen>
               </para>
                  <tip>
                      <para>Se till att ersätta DATORNAMN i ovastående exempel med namnet på den dator du vill lägga till ett konto för.</para>
                   </tip>
        </sect3>
        <sect3 id="file-permissions" status="complete">
          <title>Filrättigheter</title>
            <para>Filrättigheter definierar de uttryckliga rättigheter en dator eller användare har till en speciell katalog, fil eller uppsättning filer. Sådana rättigheter går att definiera genom att ändra på filen <filename>/etc/samba/smb.conf</filename> och specifierar de uttryckliga rättigheterna för respektive filutdelning. Om du till exempel har skapat en SAMBA-utdelning som heter <emphasis role="italic">sourcedocs</emphasis> och enbart vill dela ut läsrättigheter (<emphasis role="italic">read-only</emphasis>) till gruppen som heter <emphasis role="italic">planning</emphasis>, men vill ge gruppen <emphasis role="italic">authors</emphasis> och användaren <emphasis role="italic">richard</emphasis> skrivrättigheter skriver du följande rader under posten <emphasis role="italic">[sourcedocs]</emphasis>:</para>
               <para>
                  <emphasis role="bold">read list = @planning</emphasis>
               </para>
               <para>
                  <emphasis role="bold">write list = @authors, richard</emphasis>
               </para>
             <para>Spara <filename>/etc/samba/smb.conf</filename> för att ändringarna ska verkställas.</para>
            <para>En annan möjlig rättighet är att ge någon administrativa (<emphasis role="italic">administrative</emphasis>) rättigheter för till en delad resurs. Användare som har administrativa rättigheter kan läsa, skriva eller modifiera all information som finns i den resursen som användaren har administrativa rättigheter till. Om du till exempel vill ge användaren <emphasis role="italic">melissa</emphasis> administrativa rättigheter till vår exempel-utdelning <emphasis role="italic">sourcedocs</emphasis> behöver du redigera filen <filename>/etc/samba/smb.conf</filename> och lägga till följande rad under posten <emphasis role="italic">[sourcedocs]</emphasis>:</para>
               <para>
                  <emphasis role="bold">admin users = melissa</emphasis>
               </para>
             <para>Spara <filename>/etc/samba/smb.conf</filename> för att ändringarna ska verkställas.</para>
        </sect3>
      </sect2>
      <sect2 id="windows-networking-clients" status="complete">
        <title>Klienter</title>
          <para>Ubuntu innehåller klientprogram och möjligheter att komma åt nätverksresurser som delas över SMB-protokollet. Till exempel kan du använda verktyget <application>smbclient</application> för att komma åt utdelade filsystem på ungefär samma sätt som med en klient för File Transfer Protocol (FTP). Säg att du vill komma åt en delad mapp som heter <emphasis role="italic">documents</emphasis> som delas ut av en Windowsdator vid namn <emphasis role="italic">bill</emphasis> med <application>smbclient</application>. I så fall skulle du skriva ett kommando som ser ut ungefär såhär vid prompten:</para>
                <para>
<screen>
<command>smbclient //bill/documents -U &lt;användarnamn&gt;</command>
</screen>
                </para>
            <para>Du kommer sedan bli frågad om lösenordet för användaren du skrev efter växeln -U. Om autentiseringen lyckas kommer du att komma till en prompt där du kan skriva kommandon för att ändra på filer och överföra dem med ungefär samma kommandon som används i icke-grafiska FTP-klienter. För mer information om verktyget <application>smbclient</application> kan du läsa dess manualsida genom att skriva kommandot: <screen>
<command>
man smbclient
</command>
</screen></para>
            <para>Det går även att montera en resurs från en annan dator lokalt med SMB-protokollet med kommandot <application>mount</application>. För att till exempel montera en utdelad mapp vid namn <emphasis role="italic">project-code</emphasis> från en Windowsdator som heter <emphasis role="italic">development</emphasis> som användaren <emphasis role="italic">dlightman</emphasis> till ditt Ubuntusystems monteringspunkt /mnt/pcode, skriv det här kommandot vid prompten:</para>
                <para>
<screen>
<command>mount -t smbfs -o username=dlightman //development/project-code /mnt/pcode</command>
</screen>
                </para>
                <para>Du kommer att bli frågad om användarens lösenord, och när du har lyckats autentisera dig kommer innehållet i den utdelade resursen att finnas lokalt tillgängligt via monteringspunkten du skrev som det sista argumentet till mount-kommandot. För att koppla från den delade resursen, använd helt enkelt kommandot <application>umount</application>, precis som du skulle göra med vilket annat monterat filsystem som hellst. Till exempel:</para>
                <para>
<screen>
<command>umount /mnt/pcode</command>
</screen>
                </para>
        <sect3 id="user-accounts" status="complete">
          <title>Användarkonton</title>
            <para>Användarkonton är personer som, efter någon form av identifiering, kan använda speciella datorer och nätverksresurser. Vanligtvis i en nätverksmiljö är får alla personer som får komma åt en dator eller nätverket var sitt användarkontot, där policys och rättigheter sedan definierar de exakta rättigheterna användarkontot har tillgång till. För att definiera nätverksanvändare i SAMBA i ditt Ubuntusystem, använd kommandot <application>smbpasswd</application>. För att till exempel lägga till en SAMBA-användare till ditt Ubuntusystem med användarnamnet <emphasis role="italic">jseinfeld</emphasis> skriver du följande kommando vid prompten:</para>
                 <para>
<screen>
<command>smbpasswd -a jseinfeld</command>
</screen>
                 </para>
              <para>Programmet <application>smbpasswd</application> kommer sedan be dig skriva ett lösenord för användaren:</para>
                 <para>
                    <computeroutput>
                    New SMB password:
                    </computeroutput>
                 </para>
              <para>Skriv in lösenordet du vill använda för användaren, och <application>smbpasswd</application> ber dig nu att bekräfta lösenordet:</para>
                    <para>
                    <computeroutput>
                    Retype new SMB password:
                    </computeroutput>
                     </para>
               <para>Bekräfta lösenordet, och <application>smbpasswd</application> kommer att lägga användaren till SAMBAS lösenordsfil</para>
        </sect3>
        <sect3 id="windows-networking-groups" status="complete">
          <title>Grupper</title>
            <para>En grupp är en samling av datorer eller användare som har samma rättighetsnivåer till vissa nätverksresurser och ger dig lite möjligheten att kontrollera tillgång till resurser lite mindre finkornigt. Om till exempel en grupp som heter <emphasis role="italic">qa</emphasis> definieras och innehåller användarna <emphasis role="italic">freda</emphasis>, <emphasis role="italic">danika</emphasis> och <emphasis role="italic">rob</emphasis> och en annan grupp vid namn <emphasis role="italic">support</emphasis> skapas med användarna <emphasis role="italic">danika</emphasis>, <emphasis role="italic">jeremy</emphasis> och <emphasis role="italic">vincent</emphasis> kommer nätverksresurser som konfigureras för att släppa in gruppen <emphasis role="italic">qa</emphasis> följdaktligen släppa in freda, danika och rob, men inte jeremy eller vincent. Eftersom användaren <emphasis role="italic">danika</emphasis> tillhör både gruppen <emphasis role="italic">qa</emphasis> och <emphasis role="italic">support</emphasis> kommer hon att kunna komma åt nätverksresurser som släpper in användare från vilken som av grupperna, medans alla andra användare bara kommer att ha tillgång till nätverksresurser som just deras grupp har tillgång till.</para>
            <para>När du definierar grupper i SAMBA:s konfigurationsfil, <filename>/etc/samba/smb.conf</filename>, används ett "@" innan namnet för att visa att det är en grupp. Om du till exempel vill skapa en grupp vid namn <emphasis role="italic">sysadmin</emphasis> någonstans i <filename>/etc/samba/smb.conf</filename> skulle du behöva skriva in gruppnamnet som <emphasis role="bold">@sysadmin</emphasis>.</para>
        </sect3>
        <sect3 id="group-policy" status="complete">
          <title>Gruppolicys</title>
            <para>Gruppolicys definierar vissa inställningar i SAMBA som påverkar vilken domän eller arbetsgrupp datorns konton tillhör, och andra globala inställningar för SAMBA-servern. Till exempel, om SAMBA-servern tillhör en arbetsgrupp av Windowsdatorer som heter <emphasis role="italic">LEVELONE</emphasis> kan du ändra på <filename>/etc/samba/smb.conf</filename> och ändra på följande rad:</para>
               <para>
               <emphasis role="bold">workgroup = LEVELONE</emphasis>
               </para>
            <para>Spara filen och starta om SAMBA-demonerna för att verkställa ändringen.</para>
            <para>Andra viktiga inställningar för global policy inkluderar <emphasis role="italic">server string</emphasis>, som avgör vilket NETBIOS-namn ditt Ubuntusystem ska berätta för andra datorer på det Windows-baserade nätverket. Det här är namnet som ditt Ubuntusystem kommer att vara känt som av Windowsklienter och andra datorer som klarar av att bläddra i nätverket med SMB-protkollet. Du kan dessutom bestämma namnet och platsen för SAMBA-serverns loggfiler genom att ändra på instruktionen <emphasis role="italic">log file</emphasis> i filen <filename>/etc/samba/smb.conf</filename>.</para>
            <para>Vissa av de övriga instruktionerna som påverkar den globala gruppolicyn inkluderar anvisningar för hur alla delade resurser ska uppföra sig. Till exempel kan du skriva vissa instruktioner under rubriken  <emphasis role="italic">[global]</emphasis> i filen <filename>/etc/samba/smb.conf</filename>, varpå det kommer att påverka alla utdelade resurser, om de inte har egna instruktioner som säger emot den här instruktionen. Du kan göra alla utdelade resurser bläddringsbara för alla klienter på nätverket genom att skriva instruktionen <emphasis role="italic">browseable</emphasis> under rubriken <emphasis role="italic">[global]</emphasis> i <filename>/etc/samba/smb.conf</filename>. Instruktionen tar ett booleskt argument - true eller false. Med andra ord, om du ändrar på filen och lägger till raden:</para>
            <para>
            <emphasis role="bold">browseable = true</emphasis>
            </para>
            <para>i avdelningen <emphasis role="italic">[global]</emphasis> i <filename>/etc/samba/smb.conf</filename> så kommer alla utdelade resurser ditt Ubuntusystem erbjuder över SAMBA att gå att bläddra i av alla identifierade klienter, om inte en specifik resurs innehåller instruktionen <emphasis role="italic">browseable = false</emphasis>, eftersom det då kommer att åsidosätta den globala instruktionen.</para>
            <para>Andra exempel som fungerar ungefär likadant är instruktionerna <emphasis role="italic">public</emphasis> och <emphasis role="italic">writeable</emphasis>. Instruktionen <emphasis role="italic">public</emphasis> accepterar ett booleskt värde och avgör om en specifik delad resurs är synlig för alla klienter, oavsett om de är identifierade eller inte. Instruktionen <emphasis role="italic">writeable</emphasis> accepterar också ett booleskt värde och definierar om en specifik delad resurs är skrivbar för någon och alla nätverksklienter.</para>
        </sect3>
      </sect2>
    </sect1>
	</chapter>

