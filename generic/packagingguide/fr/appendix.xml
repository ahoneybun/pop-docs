<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE chapter PUBLIC "-//OASIS//DTD DocBook XML V4.3//EN"
	"http://www.oasis-open.org/docbook/xml/4.3/docbookx.dtd" [
<!ENTITY % globalent SYSTEM "../../../libs/global.ent">
%globalent;
<!ENTITY % cdo-C SYSTEM "../../../libs/cdo-C.ent">
%cdo-C;
<!ENTITY % pg-common SYSTEM "../pg-common.ent">
%pg-common;
<!ENTITY % xinclude SYSTEM "../../../libs/xinclude.mod">
%xinclude;
<!ENTITY language "en">
]>
<appendix id="appendix-chap" status="complete">
	<title>Annexe</title>

	<sect1 id="appendix-resources" status="complete">
		<title>Ressources supplémentaires</title>
	
		<para><emphasis role="bold">Resources Debian</emphasis>
            <itemizedlist>

                <listitem><para><ulink url="http://www.debian.org/doc/manuals/maint-guide/"> Debian New Maintainers Guide (Nouveau guide des mainteneurs Debian)</ulink> - une bonne ressource pour apprendre à empaqueter.</para></listitem>

                <listitem><para><ulink url="http://www.debian.org/doc/debian-policy/"> Debian Policy (Ligne de conduite Debian)</ulink> - Le manuel essentiel pour la ligne de conduite Debian et des distributions basées sur Debian.</para></listitem>

                <listitem><para><ulink url="http://www.debian.org/doc/manuals/developers-reference/"> Debian Developer's Reference (référence des développeurs Debian)</ulink> - Information spécifique pour les développeurs Debian mais qui contient des points intéressant pour les empaqueteurs.</para></listitem>

				<listitem><para><ulink url="http://www.netfort.gr.jp/~dancer/column/libpkg-guide/libpkg-guide.html">Library Packaging Guide </ulink> - Guide pour empaqueter les bibliothèques.</para></listitem>

				<listitem><para><ulink url="http://women.alioth.debian.org/wiki/index.php/English/PackagingTutorial">Debian Women Packaging Tutorial</ulink> - Une autre bonne introduction pour la création de paquets Debian.</para></listitem>

			</itemizedlist></para>

		<para><emphasis role="bold">Autres ressources</emphasis>
			<itemizedlist>

				<listitem><para><ulink url="http://www-106.ibm.com/developerworks/linux/library/l-debpkg.html">Tutoriel d'empaquetage IBM</ulink></para></listitem>

				<listitem><para><ulink url="https://perso.duckcorp.org/duck/cdbs-doc/cdbs-doc.xhtml">Documentation Duckcorp CDBS</ulink></para></listitem>
	
				<listitem><para><ulink url="https://wiki.ubuntu.com/MOTU/Documentation">Documentation Ubuntu MOTU</ulink></para></listitem>
		
				<listitem><para><ulink url="https://wiki.ubuntu.com/KubuntuPackagingGuide">Guide d'empaquetage Kubuntu</ulink></para></listitem>

            </itemizedlist>
		</para>

	</sect1>

	<sect1 id="appendix-chroot" status="complete" xreflabel="chroot">
		<title>L'environnement chroot</title>

		<para>Un environnement chroot est couramment utilisé pour des travaux liés aux développement et est fondamentalement une installation de logiciel liés à la construction. C'est toujours une bonne idée d'effectuer ses travaux de développement dans un environnement chroot, du fait de la nécessité fréquente d'installation de paquets de développement (dont l'usage principal est la construction de paquets). Un exemple est lorsqu'une certaine application requiert les en-têtes (headers) et la version de développement d'une librairie pour se construire (i.e. <application>libabc-dev</application>). Un utilisateur normal ne devrait pas avoir besoin de la version de développement. Il est donc préférable d'installer de tels paquets de développement dans un environnement chroot, laissant ainsi l'environnement de travail normal propre et léger. Tout d'abord installez les paquets requis :</para>
		
		<screen>sudo apt-get install dchroot debootstrap</screen>

		<important><para>Assurez-vous d'installer au minimum la version de <application>debootstrap</application> correspondant à la version  pour laquelle vous essayez de crpackages.ubuntu.com et l'installer manuellement avec dpkg -i.</para></important>
		
		<para>Les étapes suivantes sont la création, la configuration et l'entrée dans l'environnement chroot</para>
		
		<screen>
sudo mkdir /var/chroot
echo "mychroot /var/chroot" | sudo tee -a /etc/dchroot.conf
sudo debootstrap --variant=buildd edgy /var/chroot/ http://archive.ubuntu.com/ubuntu/</screen>
		
		<note><para>Créer un environnement chroot peut prendre un peu de temps car <application>debootstrap</application> télécharge et configure une installation &ubuntu; minimale.</para></note>
		
		<screen>sudo cp /etc/resolv.conf /var/chroot/etc/resolv.conf
sudo cp /etc/apt/sources.list /var/chroot/etc/apt/
sudo chroot /var/chroot/</screen>

		<para>Pour pouvoir utiliser apt dans l'environnement chroot, ajoutez les sources Ubuntu aux sources apt de chroot. Pour l'instant ignorez les avertissements à propos de l'authentification des paquets :</para>
		
		<screen>
echo "deb     http://archive.ubuntu.com/ubuntu edgy main restricted \
	universe multiverse" &gt; /etc/apt/sources.list
echo "deb-src http://archive.ubuntu.com/ubuntu edgy main restricted \
	universe multiverse" &gt;&gt; /etc/apt/sources.list
apt-get update
apt-get install build-essential dh-make automake pbuilder gnupg lintian \
	wget debconf devscripts gnupg sudo
apt-get update
exit</screen>

		<para>Éxecutez la commande suivante pour configurer les locales :</para>
		
		<screen>
sudo chroot /var/chroot/
apt-get install dialog language-pack-fr
exit</screen>

		<note><para>Si vous voulez le support d'un autre langage que le français, remplacez <emphasis>fr</emphasis> dans <application>language-pack-fr</application> par le code de langage approprié.</para></note>

		<para>Ensuite, définissez les mots de passe de l'utilisateur et du super-utilisateur (root) pour l'environnement chroot. La dernière ligne ci-dessous est pour éviter les avertissements de sudo survenant dans l'environnement chroot :</para>
		
		<screen>
sudo cp /etc/passwd /var/chroot/etc/
sudo sed 's/\([^:]*\):[^:]*:/\1:*:/' /etc/shadow | sudo tee /var/chroot/etc/shadow
sudo cp /etc/group /var/chroot/etc/
sudo cp /etc/hosts /var/chroot/etc/</screen>

		<para>Pour activer sudo, définissez votre mot de passe super-utilisateur (root) et le premier utilisateur sudo dans le groupe admin (pour l'environnement chroot). Dans les commandes suivantes, remplacez «&lt;user&gt;» par le nom d'utilisateur qui sera utilisé pour l'environnement chroot.</para>
		
		<screen>
sudo cp /etc/sudoers /var/chroot/etc/
sudo chroot /var/chroot/
dpkg-reconfigure passwd
passwd &lt;user&gt;
exit</screen>

		<para>Le fichier fstab du système doit être modifié afin que l'environnement chroot ait accès aux répertoires utilisateurs du sytème (home), temp, etc. Notez que le répertoire utilisateur (home) du système est utilisé dans l'environnement chroot.</para>
		
		<screen>sudo editor /etc/fstab</screen>
		
		<para>Ajoutez ces lignes</para>
		<screen>
/home /var/chroot/home none bind 0 0
/tmp /var/chroot/tmp none bind 0 0 
proc-chroot /var/chroot/proc proc defaults 0 0 
devpts-chroot /var/chroot/dev/pts devpts defaults 0 0 </screen>

		<para>Montez les nouvelles entrées du fstab</para>
		
		<screen>sudo mount -a</screen>
		
		<para>Le profil par défaut du bash contient l'information chroot dans l'invite de commande (prompt). Pour rendre ceci visible :</para>
		
		<screen>
sudo chroot /var/chroot/
echo mychroot &gt; /etc/debian_chroot
exit</screen>

		<para>Utilisez maintenant votre environnement chroot (vous pouvez omettre le -c mychroot s'il n'en existe q'un seul ou si vous voulez le premier de <filename>/etc/dchroot.conf</filename>). L'argument -d signifie que votre environnement sera conservé. Cet argument est généralement utile si vous voulez que des applications «chrootées» utilisent votre serveur X, votre gestionnaire de session, etc. de manière transparente.</para>
		
		<screen>dchroot -c mychroot -d</screen>
	
	</sect1>

	<sect1 id="appendix-examples" status="complete">
		<title>fichiers d'exemple <application>dh_make</application></title>

		<variablelist>
			<varlistentry>
				<term>Readme.Debian</term>
				
				<listitem><para>Ce fichier est utilisé pour documenter les modifications que vous avez faites sur la source originale (upstream) et que d'autres personnes auraient à connaître ou des informations spécifiques à Debian ou &ubuntu;.</para></listitem>
				
			</varlistentry>

			<varlistentry>
				<term>conffiles.ex</term>
				
				<listitem><para>Si le paquet installe un fichier de configuration, lorsque le paquet est mis à niveau <application>dpkg</application> peut demander à l'utilisateur s'il veut conserver sa version modifiée ou s'il veut installer la nouvelle version. De tels fichiers de configuration devraient être listés dans <filename>conffiles</filename> (un par ligne). Ne listez pas les fichiers de configuration qui sont modifiés uniquement par le paquet, ou qui doivent être établis par l'utilisateur pour fonctionner.</para></listitem>
				
			</varlistentry>

			<varlistentry>
				<term>cron.d.ex</term>

				<listitem><para>Si votre paquet requiert des tâches régulièrement exécutées pour fonctionner correctement, vous pouvez utiliser ce fichier pour le configurer. Si vous utilisez ce fichier renommez le en <filename>cron.d</filename>.</para></listitem>
				
			</varlistentry>

			<varlistentry>
				<term>dirs</term>

				<listitem><para>ce fichier spécifie des répertoires qui sont nécéssaires mais que la procédure normale d'installation (<application>make install</application>application), pour une raison ou une autre, ne crée pas.</para></listitem>
				
			</varlistentry>

			<varlistentry>
				<term>docs</term>

				<listitem><para>Ce fichier spécifie les noms de fichiers pour la documentation que <application>dh_installdocs</application> installera dans le répertoire temporaire.</para></listitem>
				
			</varlistentry>
			
			<varlistentry>
				<term>emacsen-*.ex</term>

				<listitem><para>Ce fichier spécifie les fichiers Emacs qui seront compilés vers du code octet lors de l'installation. Il sont installés dans le répertoire temporaire par <application>dh_installemacsen</application>.</para></listitem>
				
			</varlistentry>

			<varlistentry>
				<term>init.d.ex</term>

				<listitem><para>Si votre paquet est un démon qui doit être exécuté au démarrage du système, renommez ce fichier en <filename>init.d</filename> et ajustez le à vos besoins.</para></listitem>
			
			</varlistentry>

			<varlistentry>
				<term>manpage.1.ex et manpage.sgml.ex</term>

				<listitem><para>Ces fichiers sont des modèles pour les pages de <application>man</application> si votre paquet n'en contient pas déjà.</para></listitem>
				
			</varlistentry>

			<varlistentry>
				<term>menu.ex</term>

				<listitem><para>Ce fichier est utilisé pour ajouter votre paquet au menu Debian. &ubuntu; n'utilise pas le menu Debian mais les fichiers au standard <ulink url="http://www.freedesktop.org">freedesktop.org</ulink><ulink url="http://standards.freedesktop.org/desktop-entry-spec/latest/">.desktop</ulink>.</para></listitem>
				
			</varlistentry>

			<varlistentry>
				<term>watch.ex</term>

				<listitem><para>Le mainteneur du paquet peut utiliser le programme <application>uscan</application> et un fichier <filename>watch</filename> pour vérifier l'existence d'une nouvelle archive source originale (upstream).</para></listitem>
				
			</varlistentry>

			<varlistentry>
				<term>ex.package.doc-base</term>

				<listitem><para>Ce fichier est utilisé pour enregistrer la documentation de votre paquet (en dehors des pages de <application>man</application> et <application>info</application>) avec <application>doc-base</application>.</para></listitem>
				
			</varlistentry>	

			<varlistentry>
				<term>postinst.ex, preinst.ex, postrm.ex, et prerm.ex</term>

				<listitem><para>Ces scripts du mainteneur sont exécutés par <application>dpkg</application> lorsque le paquet est installé, mis à niveau, ou supprimé.</para></listitem>
				
			</varlistentry>

		</variablelist>

		<tip><para>Pour plus de détails, référez-vous au <ulink url="http://www.debian.org/doc/maint-guide/ch-dother.fr.html">Debian New Maintainer's Guide (Nouveau guide du mainteneur Debian)</ulink></para></tip>
			
	</sect1>

	
	<sect1 id="appendix-debhelper" status="complete">
		<title>Liste des scripts <application>debhelper</application></title>

<itemizedlist>

<listitem>
		<para>dh_builddeb</para>
</listitem>

<listitem>
		<para>dh_clean</para>
</listitem>

<listitem>
		<para>dh_compress</para>
</listitem>

<listitem>
		<para>dh_desktop</para>
</listitem>

<listitem>
		<para>dh_fixperms</para>
</listitem>

<listitem>
		<para>dh_gconf</para>
</listitem>

<listitem>
		<para>dh_gencontrol</para>
</listitem>

<listitem>
		<para>dh_iconcache</para>
</listitem>

<listitem>
		<para>dh_install</para>
</listitem>

<listitem>
		<para>dh_installcatalogs</para>
</listitem>

<listitem>
		<para>dh_installchangelogs</para>
</listitem>

<listitem>
		<para>dh_installcron</para>
</listitem>

<listitem>
		<para>dh_installdeb</para>
</listitem>

<listitem>
		<para>dh_installdebconf</para>
</listitem>

<listitem>
		<para>dh_installdefoma</para>
</listitem>

<listitem>
		<para>dh_installdirs</para>
</listitem>

<listitem>
		<para>dh_installdocs</para>
</listitem>

<listitem>
		<para>dh_installemacsen</para>
</listitem>

<listitem>
		<para>dh_installexamples</para>
</listitem>

<listitem>
		<para>dh_installinfo</para>
</listitem>

<listitem>
		<para>dh_installinit</para>
</listitem>

<listitem>
		<para>dh_installlogcheck</para>
</listitem>

<listitem>
		<para>dh_installlogrotate</para>
</listitem>

<listitem>
		<para>dh_installman</para>
</listitem>

<listitem>
		<para>dh_installmenu</para>
</listitem>

<listitem>
		<para>dh_installmime</para>
</listitem>

<listitem>
		<para>dh_installmodules</para>
</listitem>

<listitem>
		<para>dh_installpam</para>
</listitem>

<listitem>
		<para>dh_installppp</para>
</listitem>

<listitem>
		<para>dh_installtexfonts</para>
</listitem>

<listitem>
		<para>dh_installwm</para>
</listitem>

<listitem>
		<para>dh_installxfonts</para>
</listitem>

<listitem>
		<para>dh_installxmlcatalogs</para>
</listitem>

<listitem>
		<para>dh_link</para>
</listitem>

<listitem>
		<para>dh_listpackages</para>
</listitem>

<listitem>
		<para>dh_makeshlibs</para>
</listitem>

<listitem>
		<para>dh_md5sums</para>
</listitem>

<listitem>
		<para>dh_perl</para>
</listitem>

<listitem>
		<para>dh_python</para>
</listitem>

<listitem>
		<para>dh_scrollkeeper</para>
</listitem>

<listitem>
		<para>dh_shlibdeps</para>
</listitem>

<listitem>
		<para>dh_strip</para>
</listitem>

<listitem>
		<para>dh_testdir</para>
</listitem>

<listitem>
		<para>dh_testroot</para>
</listitem>

<listitem>
		<para>dh_usrlocal</para>
</listitem>

</itemizedlist>


	</sect1>

</appendix>

