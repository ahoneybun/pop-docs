<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE chapter PUBLIC "-//OASIS//DTD DocBook XML V4.3//EN" 
	"http://www.oasis-open.org/docbook/xml/4.3/docbookx.dtd" [
<!ENTITY % globalent SYSTEM "../../../libs/global.ent">
%globalent;
<!ENTITY % cdo-C SYSTEM "../../../libs/cdo-C.ent">
%cdo-C;
<!ENTITY % pg-common SYSTEM "../pg-common.ent">
%pg-common;
<!ENTITY % xinclude SYSTEM "../../../libs/xinclude.mod">
%xinclude;
<!ENTITY language "en">
]>
<chapter id="gs-chap" status="review">
	<title>Getting Started</title>

	<sect1 id="gs-bin_source" status="complete">
		<title>Pacotes Fonte e Binários</title>
		
		<para>A maioria dos utilizadores de uma distribuição baseada no Debian como o &ubuntu; nunca terão de lidar com o código fonte actual que é usado para criar todas as aplicações nos seus computadores. Em vez disso, o código fonte é compilado para pacotes <emphasis>binários</emphasis> a partir do pacote <emphasis>fonte</emphasis> que contém  tanto o código fonte em si e as regras para fazer um pacote binário. Os empacotadores enviam os pacotes fonte com as suas mudanças para os sistemas de construção que então compilam os pacotes binários para cada arquitectura. Um sistema separado distribui o binário .deb e as mudanças da fonte para os respositórios espelho.</para>

	</sect1>

	<sect1 id="gs-tools" status="review">
		<title>Ferramentas de Empacotamento</title>
		
		<para>Existem muitas ferramentas escritas especialmente para empacotamento em sistemas baseados no Debian. Muitas delas não são <emphasis>essenciais</emphasis> para criar pacotes mas são muito úteis e muitas vezes automatizam tarefas repetitivas. As suas páginas de <application>man</application> e <application>info</application> são boas fontes de informação. No entanto, o seguinte é uma lista de pacotes que julgamos que são necessários para começar a criar pacotes:</para>

		<variablelist>
			<varlistentry>
				<term><application>build-essential</application></term>
				<listitem><para>é um metapacote que depende de <application>libc6-dev</application>, <application>gcc</application>, <application>g++</application>, <application>make</application>, e <application>dpkg-dev</application>. Um pacote com o qual não deve estar familiarizado é o <application>dpkg-dev</application>. Contém ferramentas tais como <application>dpkg-buildpackage</application> e <application>dpkg-source</application> que são usadas para criar, desempacotar, e construir pacotes fonte e binários.</para></listitem>
			</varlistentry>

			<varlistentry>
				<term><application>devscripts</application></term>
				<listitem><para>contém muitos scripts que fazem com que o trabalho de manutenção do responsável pelo pacote seja mais fácil. Alguns dos mais comuns usados são <application>debdiff</application>, <application>dch</application>, <application>debuild</application>, e <application>debsign</application>.</para></listitem>
			</varlistentry>

			<varlistentry><term><application>debhelper</application> e <application>dh-make</application></term>
				<listitem><para>são scripts que automatizam tarefas comuns de empacotamento. <application>dh-make</application> pode ser usado para a "debianização" inicial e fornece muitos ficheiros exemplo.</para></listitem>
			</varlistentry>
				
			<varlistentry><term><application>diff</application> e <application>patch</application></term> <listitem><para>são usados para criar e aplicar correcções, respectivamente. São usados extensivamente no empacotamento porque é mais fácil, limpo, e mais eficiente para representar pequenas alterações como correcções em vez de ter múltiplas cópias de um ficheiro.</para></listitem> </varlistentry>
			
			<varlistentry><term><application>gnupg</application></term>
				<listitem><para>é um substituto completamente livre do PGP usado para assinar digitalmente ficheiros (incluindo pacotes).</para></listitem>
			</varlistentry>
				
			<varlistentry><term><application>fakeroot</application></term>
				<listitem><para>simula um comando em execução com privilégios de root.  Isto é útil para criar pacotes binários como um utilizador normal.</para></listitem>
			</varlistentry>
			
			<varlistentry><term><application>lintian</application> e <application>linda</application></term>
				<listitem><para>disseca pacotes Debian e relata erros e violações de Políticas. Contêm verificações automáticas para muitos dos aspectos das políticas Debian bem como para erros comuns.</para></listitem>
			</varlistentry>
			
			<varlistentry><term><application>pbuilder</application></term>
				<listitem><para>constrói um sistema chroot e cria um pacote dentro do chroot. É um sistema ideal para usar para verificar que um pacote tem dependências correctas de criação e para criar pacotes limpos para serem testados e distribuidos.</para></listitem> </varlistentry>
		</variablelist>

	</sect1>

		
	<sect1 id="gs-pbuilder" status="complete" xreflabel="pbuilder">
		<title>O Construtor Pessoal: pbuilder</title>
		
		<para>Usar o pbuilder como um construtor de pacotes permite-lhe construir o pacote a partir de um ambiente chroot. Pode construir pacotes binários sem usar o <application>pbuilder</application>, mas tem que ter todas as dependências de construção instaladas em primeiro no seu sistema. No entanto, o pbuilder permite ao empacotador verficar as dependências de construção porque o pacote é construído dentro de uma instalação mínima do &ubuntu;, e as dependências de construção são descarregadas de acordo com o ficheiro <filename>debian/control</filename> file.</para>

		<para>O seguinte é um guia breve para instalar, usar, e actualizar um ambiente pbuilder. No entanto, existem muitos detalhes de uso do <application>pbuilder</application>  que saem fora dos horizontes deste guia. A página do man do <application>pbuilder</application> tem muita informação e deve ser consultada se tiver problemas ou precisar de informação mais detalhada.</para>

	<sect2>
		<title>Instalar e Configurar um ambiente pbuilder</title>
		
		<para>A primeira coisa, e talvez a mais óbvia, a fazer é instalar o <application>pbuilder</application>. Se quiser criar o <application>pbuilder</application>  para uma versão mais recente do que aquela que tem instalada, terá que instalar manualmente o <application>debootstrap</application> .deb (a partir de <ulink url="&p.u.c;">&p.u.c;</ulink>) a partir da versão mais recente. Para criar um pbuilder execute:</para>
		
		<screen>
sudo pbuilder create --distribution &lt;distro&gt; \
	--othermirror "deb http://archive.ubuntu.com/ubuntu &lt;distro&gt; universe multiverse"
		</screen>

		<para>where &lt;distro&gt; is the release you want
			(<emphasis>&ubuntuplus1;</emphasis> for instance) to create the
			pbuilder for. If you would like to create more than one
			<application>pbuilder</application> environment you can
			append the <emphasis>--basetgz</emphasis> flag with the
			desired location for the
			compressed <application>pbuilder</application>
			environment.  The default
			is <filename>/var/cache/pbuilder/base.tgz</filename>.  If
			you do choose to use <emphasis>--basetgz</emphasis> you
			will need to use it with the
			other <application>pbuilder</application> commands
			so <application>pbuilder</application> knows which
			compressed build environment to use.</para>
		
		<note><para>Criar um ambiente pbuilder demorará algum tempo porque <application>debootstrap</application> essencialmente descarregará uma instalação mínima &ubuntu;.</para></note>

		<tip><para>Uma maneira mais flexível para criar um pbuilder (e talvez vários pbuilders) é usar um script de shell.</para></tip>

	</sect2>	
	
	<sect2>
		<title>Using the pbuilder</title>
		<para>Agora que tem um pbuilder a correr pode criar pacotes binários a partir do pacote fonte invocando:</para>

		<screen>sudo pbuilder build *.dsc</screen>

		<para>Isto irá construir todos os pacotes fonte na directoria actual. Os .debs resultantes e pacotes fonte podem ser encontrados em <filename>/var/cache/pbuilder/result/</filename> (que pode ser mudado com a marca <emphasis>--buildresult</emphasis>).</para>

	</sect2>

	<sect2>
		<title>Actualizando o pbuilder</title>
		
		<para>Deve ter sempre um pbuilder actualizado sempre que estiver a testar os seus pacotes fonte, especialmente quando estiver a construir para uma versão de desenvolvimento que está a mudar rápidamente, para assegurar que as dependências são encontradas adequadamente. Para actualizar o seu pbuilder, use:</para>

		<screen>sudo pbuilder update</screen>

		<para/>
		
		<para>Se quiser actualizar o seu pbuilder para uma nova versão pode usar <application>pbuilder update</application> em combinação com a opção <emphasis>--distribution</emphasis>:</para>

		<screen>sudo pbuilder update --distribution &lt;newdistro&gt; --override-config</screen>

	</sect2>
	
	<sect2>
		<title>Múltiplos pbuilders</title>
		
		<para>Toda a informação até agora nesta secção acerca do <application>pbuilder</application> aplicou-se para um único <application>pbuilder</application>. Se quer criar mais de um <application>pbuilder</application> pode criar um script de shell para lidar com a configuração para cada <application>pbuilder</application> que quiser criar. Um exemplo de um tal script de shell pode ser encontrado em <filename>/usr/share/doc/pbuilder/examples/pbuilder-distribution.sh</filename>. Pode simplesmente copiar este exemplo algures para o seu caminho (colocando isto em <filename>~/bin/</filename> e adicionando a directoria ao seu caminho de execução é conveniente) e a seguir editá-lo de acordo com as suas necessidades. Normalmente precisará apenas de mudar DISTRIBUTION e adicionar --othermirror como em cima. Pode executar este script em vez do <application>pbuilder</application> directamente.</para></sect2>
	
</sect1>

</chapter>

